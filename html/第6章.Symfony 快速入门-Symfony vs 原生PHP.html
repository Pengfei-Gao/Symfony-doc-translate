<!DOCTYPE html><html><head><style type="text/css" id="wiz_custom_css"> html, body { font-size: 15px; } body { font-family: Helvetica, "Hiragino Sans GB", "Microsoft Yahei", SimSun, SimHei, arial, sans-serif; line-height: 1.6; padding: 0; margin: 20px 36px; margin: 1.33rem 2.4rem; } h1, h2, h3, h4, h5, h6 { margin: 20px 0 10px; margin: 1.33rem 0 0.667rem; padding: 0; font-weight: bold; } h1 { font-size: 21px; font-size: 1.4rem; } h2 { font-size: 20px; font-size: 1.33rem; } h3 { font-size: 18px; font-size: 1.2rem; } h4 { font-size: 17px; font-size: 1.13rem; } h5 { font-size: 15px; font-size: 1rem; } h6 { font-size: 15px; font-size: 1rem; color: #777777; margin: 1rem 0; } div, p, blockquote, ul, ol, dl, table, pre { margin: 10px 0; margin: 0.667rem 0; } ul, ol { padding-left: 32px; padding-left: 2.13rem; } blockquote { border-left: 4px solid #dddddd; padding: 0 12px; padding: 0 0.8rem; color: #aaa; } blockquote > :first-child { margin-top: 0; } blockquote > :last-child { margin-bottom: 0; } img { border: 0; max-width: 100%; height: auto !important; } table { border-collapse: collapse; border: 1px solid #bbbbbb; } td { border-collapse: collapse; border: 1px solid #bbbbbb; } @media screen and (max-width: 660px) { body { margin: 20px 18px; margin: 1.33rem 1.2rem; } } @media only screen and (-webkit-max-device-width: 1024px), only screen and (-o-max-device-width: 1024px), only screen and (max-device-width: 1024px), only screen and (-webkit-min-device-pixel-ratio: 3), only screen and (-o-min-device-pixel-ratio: 3), only screen and (min-device-pixel-ratio: 3) { html, body { font-size: 17px; } body { line-height: 1.7; margin: 12px 15px; margin: 0.75rem 0.9375rem; color: #353c47; } h1 { font-size: 34px; font-size: 2.125rem; } h2 { font-size: 30px; font-size: 1.875rem; } h3 { font-size: 26px; font-size: 1.625rem; } h4 { font-size: 22px; font-size: 1.375rem; } h5 { font-size: 18px; font-size: 1.125rem; } h6 { color: inherit; } div, p, blockquote, ul, ol, dl, table, pre { margin: 0; } ul, ol { padding-left: 40px; padding-left: 2.5rem; } blockquote { border-left: 4px solid #c8d4e8; padding: 0 15px; padding: 0 0.9375rem; color: #b3c2dd; } } </style><style type="text/css" id="wiz_todo_style_id" wiz_link_version="01.00.09">.wiz-todo, .wiz-todo-img {width: 16px; height: 16px; cursor: default; padding: 0 10px 0 2px; vertical-align: -10%;-webkit-user-select: none;} .wiz-todo-label { display: inline-block; padding-top: 7px; padding-bottom: 6px; line-height: 1.5;} .wiz-todo-label-checked { /*text-decoration: line-through;*/ color: #666;} .wiz-todo-label-unchecked {text-decoration: initial;} .wiz-todo-completed-info {padding-left: 44px; display: inline-block; } .wiz-todo-avatar { width:20px; height: 20px; vertical-align: -20%; margin-right:10px; border-radius: 2px;} .wiz-todo-account, .wiz-todo-dt { color: #666; }</style><link type="text/css" rel="stylesheet" id="wiz_code_highlight_link" href="第6章.Symfony 快速入门-Symfony vs 原生PHP_files/wiz_code_highlight.css"></head><body><p><img border="0" width="106" height="42" _src="第6章.Symfony 快速入门-Symfony vs 原生PHP_files/e7a5fb96-9d85-4388-834d-87a9989c5ae8.gif" style="height: 42px; white-space: normal; width: 106px;" src="第6章.Symfony 快速入门-Symfony vs 原生PHP_files/e7a5fb96-9d85-4388-834d-87a9989c5ae8.gif" />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<img border="0" width="147" height="59" _src="第6章.Symfony 快速入门-Symfony vs 原生PHP_files/31818df4-6479-4bbd-8b12-8d54db9f7066.gif" style="height: 59px; line-height: 1.6; white-space: normal; width: 147px;" src="第6章.Symfony 快速入门-Symfony vs 原生PHP_files/31818df4-6479-4bbd-8b12-8d54db9f7066.gif" />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<img border="0" width="109" height="44" _src="第6章.Symfony 快速入门-Symfony vs 原生PHP_files/c1351b29-d6fc-4d5b-a55a-3e33dfca5515.gif" style="height: 44px; line-height: 1.6; white-space: normal; font-weight: bold; width: 109px;" src="第6章.Symfony 快速入门-Symfony vs 原生PHP_files/c1351b29-d6fc-4d5b-a55a-3e33dfca5515.gif" /></p><p>&nbsp;&nbsp;&nbsp;&nbsp;学到了这里你可能还有疑问,为甚麽要使用<strong>Symfony </strong>呢,打开一个php文件直接去编写代码不是更好吗?</p><p><span style="line-height: 27px;">&nbsp;&nbsp;&nbsp;&nbsp;如果你从来没有使用过任何的PHP框架，并且对<span style="line-height: 27px;">MVC的理念一点都不熟悉</span>,仅仅只是听说很多人都在用Symfony,所依你也打算用,那末这一章就是为你准备的.在这一章里,我并不会教你如何用Symfony去开发一个比原生的php脚本运行速度更快,更好地软件,因为那完全时取决与你自己的.</span><br/></p><p><span style="line-height: 27px;">&nbsp;&nbsp;&nbsp;&nbsp;在这一章里,我将会带着你用原生的php来写一些简单的应用,然后用<span style="line-height: 27px;">Symfony重构他,让它变得更加优秀!!我们将回溯历史,你会看到web开发在过去的几十年来的进化史.</span></span></p><p>&nbsp;&nbsp;&nbsp;&nbsp;通过前面几章的学习,相信你已经看到了<span style="line-height: 27px;">Symfony是如果拯救你平凡的项目的,并且让你重新获取对你的代码的控制!!</span></p><p><span style="line-height: 27px;"><br/></span></p><h2><br/></h2><h2>使用原生的PHP创建一个简单博客程序<span style="font-family: Arial; font-size: 15px; line-height: 1.6;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span></h2><p>&nbsp;&nbsp;&nbsp;&nbsp;在这一章中,我们将先使用原生的php来构建一个简单的博客程序!那末,现在开始吧!让我们创建一个简单的博客入口程序,并且这个入口极有可能也已经连接数据库.用原生的php来完成这些事这是非常快速,但也非常繁琐的一项工作!<br/></p><pre class="prettyprint linenums prettyprinted" style=""><ol class="linenums list-paddingleft-2"><li class="L0"><code class="language-php"><span class="pun">&lt;?</span><span class="pln">php</span></code></li><li class="L1"><code class="language-php"><span class="com">// index.php</span></code></li><li class="L2"><code class="language-php"><span class="pln">$link </span><span class="pun">=</span><span class="pln"> mysql_connect</span><span class="pun">(</span><span class="str">&#39;localhost&#39;</span><span class="pun">,</span><span class="pln"> </span><span class="str">&#39;myuser&#39;</span><span class="pun">,</span><span class="pln"> </span><span class="str">&#39;mypassword&#39;</span><span class="pun">);</span></code></li><li class="L3"><code class="language-php"><span class="pln">mysql_select_db</span><span class="pun">(</span><span class="str">&#39;blog_db&#39;</span><span class="pun">,</span><span class="pln"> $link</span><span class="pun">);</span></code></li><li class="L4"><code class="language-php"></code></li><li class="L5"><code class="language-php"><span class="pln">$result </span><span class="pun">=</span><span class="pln"> mysql_query</span><span class="pun">(</span><span class="str">&#39;SELECT id, title FROM post&#39;</span><span class="pun">,</span><span class="pln"> $link</span><span class="pun">);</span></code></li><li class="L6"><code class="language-php"><span class="pun">?&gt;</span></code></li><li class="L7"><code class="language-php"></code></li><li class="L8"><code class="language-php"><span class="dec">&lt;!DOCTYPE html&gt;</span></code></li><li class="L9"><code class="language-php"><span class="tag">&lt;html&gt;</span></code></li><li class="L0"><code class="language-php"><span class="pln"> &nbsp; &nbsp;</span><span class="tag">&lt;head&gt;</span></code></li><li class="L1"><code class="language-php"><span class="pln"> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="tag">&lt;title&gt;</span><span class="pln">List of Posts</span><span class="tag">&lt;/title&gt;</span></code></li><li class="L2"><code class="language-php"><span class="pln"> &nbsp; &nbsp;</span><span class="tag">&lt;/head&gt;</span></code></li><li class="L3"><code class="language-php"><span class="pln"> &nbsp; &nbsp;</span><span class="tag">&lt;body&gt;</span></code></li><li class="L4"><code class="language-php"><span class="pln"> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="tag">&lt;h1&gt;</span><span class="pln">List of Posts</span><span class="tag">&lt;/h1&gt;</span></code></li><li class="L5"><code class="language-php"><span class="pln"> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="tag">&lt;ul&gt;</span></code></li><li class="L6"><code class="language-php"><span class="pln"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="pun">&lt;?</span><span class="pln">php </span><span class="kwd">while</span><span class="pln"> </span><span class="pun">(</span><span class="pln">$row </span><span class="pun">=</span><span class="pln"> mysql_fetch_assoc</span><span class="pun">(</span><span class="pln">$result</span><span class="pun">)):</span><span class="pln"> </span><span class="pun">?&gt;</span></code></li><li class="L7"><code class="language-php"><span class="pln"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="tag">&lt;li&gt;</span></code></li><li class="L8"><code class="language-php"><span class="pln"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;a href=&quot;/show.php?id=</span><span class="pun">&lt;?</span><span class="pln">php echo $row</span><span class="pun">[</span><span class="str">&#39;id&#39;</span><span class="pun">]</span><span class="pln"> </span><span class="pun">?&gt;</span><span class="pln">&quot;&gt;</span></code></li><li class="L9"><code class="language-php"><span class="pln"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="pun">&lt;?</span><span class="pln">php echo $row</span><span class="pun">[</span><span class="str">&#39;title&#39;</span><span class="pun">]</span><span class="pln"> </span><span class="pun">?&gt;</span></code></li><li class="L0"><code class="language-php"><span class="pln"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="tag">&lt;/a&gt;</span></code></li><li class="L1"><code class="language-php"><span class="pln"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="tag">&lt;/li&gt;</span></code></li><li class="L2"><code class="language-php"><span class="pln"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="pun">&lt;?</span><span class="pln">php endwhile </span><span class="pun">?&gt;</span></code></li><li class="L3"><code class="language-php"><span class="pln"> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="tag">&lt;/ul&gt;</span></code></li><li class="L4"><code class="language-php"><span class="pln"> &nbsp; &nbsp;</span><span class="tag">&lt;/body&gt;</span></code></li><li class="L5"><code class="language-php"><span class="tag">&lt;/html&gt;</span></code></li><li class="L6"><code class="language-php"></code></li><li class="L7"><code class="language-php"><span class="pun">&lt;?</span><span class="pln">php</span></code></li><li class="L8"><code class="language-php"><span class="pln">mysql_close</span><span class="pun">(</span><span class="pln">$link</span><span class="pun">);</span></code></li><li class="L9"><code class="language-php"><span class="pun">?&gt;</span></code></li></ol></pre><br/><p>&nbsp;&nbsp;&nbsp;&nbsp;这样编写起来速度是相当快的,但是随着你的应用程序成长,这种开发效率是不可能保持的!有迹象表明,需要解决如下几个问题:</p><ol style="list-style-type: decimal;" class=" list-paddingleft-2"><li><p>没有错误检查:万一数据库连接失败了该怎莫办!</p></li><li><p>组织不力:如果应用功能和需求一旦开始增长,这种简单的文件将会快速增加从而导致项目不能正常维护.你应该将你处理表单提交的代码放置在哪里呢?你怎莫去验证数据呢?你应该将发送电子邮件的代码放在哪里呢?</p></li><li><p>很难重用代码:因为一切都被写在了同一个文件中,没有办法重用任何部分的代码在其他的页面中!</p></li></ol><p>&nbsp;&nbsp;&nbsp;&nbsp;在这里还有一个问题,整个程序已经完全依赖于mysql了!虽然在这里没有提及,但是万一你以后想到更换一个更高效的付费数据库的时候你该怎莫办呢?Symfony全面整合了<a class="reference external" href="http://www.doctrine-project.org">Doctrine</a>&nbsp;类库,这个类库致力于数据库的抽象和映射!</p><h3><br/></h3><h3>展现分离</h3><p>&nbsp;&nbsp;&nbsp;&nbsp;代码可以从已经准备用来做html展示的应用逻辑中获取:<br/></p><pre class="prettyprint linenums prettyprinted" style=""><ol class="linenums list-paddingleft-2"><li class="L0"><code class="language-php"><span class="pun">&lt;?</span><span class="pln">php</span></code></li><li class="L1"><code class="language-php"><span class="com">// index.php</span></code></li><li class="L2"><code class="language-php"><span class="pln">$link </span><span class="pun">=</span><span class="pln"> mysql_connect</span><span class="pun">(</span><span class="str">&#39;localhost&#39;</span><span class="pun">,</span><span class="pln"> </span><span class="str">&#39;myuser&#39;</span><span class="pun">,</span><span class="pln"> </span><span class="str">&#39;mypassword&#39;</span><span class="pun">);</span></code></li><li class="L3"><code class="language-php"><span class="pln">mysql_select_db</span><span class="pun">(</span><span class="str">&#39;blog_db&#39;</span><span class="pun">,</span><span class="pln"> $link</span><span class="pun">);</span></code></li><li class="L4"><code class="language-php"></code></li><li class="L5"><code class="language-php"><span class="pln">$result </span><span class="pun">=</span><span class="pln"> mysql_query</span><span class="pun">(</span><span class="str">&#39;SELECT id, title FROM post&#39;</span><span class="pun">,</span><span class="pln"> $link</span><span class="pun">);</span></code></li><li class="L6"><code class="language-php"></code></li><li class="L7"><code class="language-php"><span class="pln">$posts </span><span class="pun">=</span><span class="pln"> array</span><span class="pun">();</span></code></li><li class="L8"><code class="language-php"><span class="kwd">while</span><span class="pln"> </span><span class="pun">(</span><span class="pln">$row </span><span class="pun">=</span><span class="pln"> mysql_fetch_assoc</span><span class="pun">(</span><span class="pln">$result</span><span class="pun">))</span><span class="pln"> </span><span class="pun">{</span></code></li><li class="L9"><code class="language-php"><span class="pln"> &nbsp; &nbsp;$posts</span><span class="pun">[]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> $row</span><span class="pun">;</span></code></li><li class="L0"><code class="language-php"><span class="pun">}</span></code></li><li class="L1"><code class="language-php"></code></li><li class="L2"><code class="language-php"><span class="pln">mysql_close</span><span class="pun">(</span><span class="pln">$link</span><span class="pun">);</span></code></li><li class="L3"><code class="language-php"></code></li><li class="L4"><code class="language-php"><span class="com">// include the HTML presentation code</span></code></li><li class="L5"><code class="language-php"><span class="kwd">require</span><span class="pln"> </span><span class="str">&#39;templates/list.php&#39;</span><span class="pun">;</span></code></li></ol></pre><p>&nbsp;&nbsp;&nbsp;&nbsp;可以看到,html代码现在被存储在一个分离的文件中(<code class="docutils literal"><span style="color: rgb(255, 0, 0);">templates/list.php</span></code>),这是一个在模板中使用类似于php语法结构的文件:</p><pre class="prettyprint linenums prettyprinted" style=""><ol class="linenums list-paddingleft-2"><li class="L0"><code class="language-php"><span class="dec">&lt;!DOCTYPE html&gt;</span></code></li><li class="L1"><code class="language-php"><span class="tag">&lt;html&gt;</span></code></li><li class="L2"><code class="language-php"><span class="pln"> &nbsp; &nbsp;</span><span class="tag">&lt;head&gt;</span></code></li><li class="L3"><code class="language-php"><span class="pln"> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="tag">&lt;title&gt;</span><span class="pln">List of Posts</span><span class="tag">&lt;/title&gt;</span></code></li><li class="L4"><code class="language-php"><span class="pln"> &nbsp; &nbsp;</span><span class="tag">&lt;/head&gt;</span></code></li><li class="L5"><code class="language-php"><span class="pln"> &nbsp; &nbsp;</span><span class="tag">&lt;body&gt;</span></code></li><li class="L6"><code class="language-php"><span class="pln"> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="tag">&lt;h1&gt;</span><span class="pln">List of Posts</span><span class="tag">&lt;/h1&gt;</span></code></li><li class="L7"><code class="language-php"><span class="pln"> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="tag">&lt;ul&gt;</span></code></li><li class="L8"><code class="language-php"><span class="pln"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="pun">&lt;?</span><span class="pln">php </span><span class="kwd">foreach</span><span class="pln"> </span><span class="pun">(</span><span class="pln">$posts </span><span class="kwd">as</span><span class="pln"> $post</span><span class="pun">):</span><span class="pln"> </span><span class="pun">?&gt;</span></code></li><li class="L9"><code class="language-php"><span class="pln"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="tag">&lt;li&gt;</span></code></li><li class="L0"><code class="language-php"><span class="pln"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;a href=&quot;/read?id=</span><span class="pun">&lt;?</span><span class="pln">php echo $post</span><span class="pun">[</span><span class="str">&#39;id&#39;</span><span class="pun">]</span><span class="pln"> </span><span class="pun">?&gt;</span><span class="pln">&quot;&gt;</span></code></li><li class="L1"><code class="language-php"><span class="pln"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="pun">&lt;?</span><span class="pln">php echo $post</span><span class="pun">[</span><span class="str">&#39;title&#39;</span><span class="pun">]</span><span class="pln"> </span><span class="pun">?&gt;</span></code></li><li class="L2"><code class="language-php"><span class="pln"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="tag">&lt;/a&gt;</span></code></li><li class="L3"><code class="language-php"><span class="pln"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="tag">&lt;/li&gt;</span></code></li><li class="L4"><code class="language-php"><span class="pln"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="pun">&lt;?</span><span class="pln">php endforeach </span><span class="pun">?&gt;</span></code></li><li class="L5"><code class="language-php"><span class="pln"> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="tag">&lt;/ul&gt;</span></code></li><li class="L6"><code class="language-php"><span class="pln"> &nbsp; &nbsp;</span><span class="tag">&lt;/body&gt;</span></code></li><li class="L7"><code class="language-php"><span class="tag">&lt;/html&gt;</span></code></li></ol></pre><p>&nbsp;&nbsp;&nbsp;&nbsp;通过转换,这个文件已经在<code class="docutils literal"><span style="color: rgb(255, 0, 0);">index.php</span></code>中包含了所有的应用逻辑,这就是所谓的&quot;控制器(<code class="docutils literal"><span style="color: rgb(255, 0, 0);">controller</span></code>)&quot;!!不管你用什莫编程语言,使用什莫框架,关于术语控制器(<code class="docutils literal"><span style="color: rgb(255, 0, 0);">controller</span></code>)你可能已经听过很多次了!他是用来处理用户输入和响应的一部分代码,说的笼统一些就是做逻辑处理的!<br/></p><p>&nbsp;&nbsp;&nbsp;&nbsp;在这种情况下,控制器(<code class="docutils literal"><span style="color: rgb(255, 0, 0);">controller</span></code>)丛数据库获取数据,并且渲染一个模板来展示数据,通过控制器的孤立,当你想要用其他的格式(比如<code class="docutils literal"><span style="color: rgb(255, 0, 0);">JSON</span></code>格式:<code class="docutils literal"><span style="color: rgb(255, 0, 0);">list.json.php</span></code>)来展示博客入口的时候,你只需要简单的改变模板文件就好了!</p><p></p><h3><br/></h3><h3>业务逻辑分离</h3><p>&nbsp;&nbsp;&nbsp;&nbsp;迄今为止,应用仅仅只包含了一个页面!但是如果有第二个页面想要去使用相同的数据库链接甚至于想要相同的博客文章排列呢?这时,我们需要<span style="line-height: 1.6;">重构代码，使应用程序的核心行为和数据访问功能被隔离在一个新的名为</span><code class="docutils literal"><span style="color: rgb(255, 0, 0);">model.php</span></code><span style="line-height: 1.6;">文件中：</span></p><p><span style="line-height: 1.6;"></span></p><pre class="prettyprint linenums prettyprinted" style=""><ol class="linenums list-paddingleft-2"><li class="L0"><code class="language-php"><span class="pun">&lt;?</span><span class="pln">php</span></code></li><li class="L1"><code class="language-php"><span class="com">// model.php</span></code></li><li class="L2"><code class="language-php"><span class="kwd">function</span><span class="pln"> open_database_connection</span><span class="pun">()</span></code></li><li class="L3"><code class="language-php"><span class="pun">{</span></code></li><li class="L4"><code class="language-php"><span class="pln"> &nbsp; &nbsp;$link </span><span class="pun">=</span><span class="pln"> mysql_connect</span><span class="pun">(</span><span class="str">&#39;localhost&#39;</span><span class="pun">,</span><span class="pln"> </span><span class="str">&#39;myuser&#39;</span><span class="pun">,</span><span class="pln"> </span><span class="str">&#39;mypassword&#39;</span><span class="pun">);</span></code></li><li class="L5"><code class="language-php"><span class="pln"> &nbsp; &nbsp;mysql_select_db</span><span class="pun">(</span><span class="str">&#39;blog_db&#39;</span><span class="pun">,</span><span class="pln"> $link</span><span class="pun">);</span></code></li><li class="L6"><code class="language-php"></code></li><li class="L7"><code class="language-php"><span class="pln"> &nbsp; &nbsp;</span><span class="kwd">return</span><span class="pln"> $link</span><span class="pun">;</span></code></li><li class="L8"><code class="language-php"><span class="pun">}</span></code></li><li class="L9"><code class="language-php"></code></li><li class="L0"><code class="language-php"><span class="kwd">function</span><span class="pln"> close_database_connection</span><span class="pun">(</span><span class="pln">$link</span><span class="pun">)</span></code></li><li class="L1"><code class="language-php"><span class="pun">{</span></code></li><li class="L2"><code class="language-php"><span class="pln"> &nbsp; &nbsp;mysql_close</span><span class="pun">(</span><span class="pln">$link</span><span class="pun">);</span></code></li><li class="L3"><code class="language-php"><span class="pun">}</span></code></li><li class="L4"><code class="language-php"></code></li><li class="L5"><code class="language-php"><span class="kwd">function</span><span class="pln"> get_all_posts</span><span class="pun">()</span></code></li><li class="L6"><code class="language-php"><span class="pun">{</span></code></li><li class="L7"><code class="language-php"><span class="pln"> &nbsp; &nbsp;$link </span><span class="pun">=</span><span class="pln"> open_database_connection</span><span class="pun">();</span></code></li><li class="L8"><code class="language-php"></code></li><li class="L9"><code class="language-php"><span class="pln"> &nbsp; &nbsp;$result </span><span class="pun">=</span><span class="pln"> mysql_query</span><span class="pun">(</span><span class="str">&#39;SELECT id, title FROM post&#39;</span><span class="pun">,</span><span class="pln"> $link</span><span class="pun">);</span></code></li><li class="L0"><code class="language-php"><span class="pln"> &nbsp; &nbsp;$posts </span><span class="pun">=</span><span class="pln"> array</span><span class="pun">();</span></code></li><li class="L1"><code class="language-php"><span class="pln"> &nbsp; &nbsp;</span><span class="kwd">while</span><span class="pln"> </span><span class="pun">(</span><span class="pln">$row </span><span class="pun">=</span><span class="pln"> mysql_fetch_assoc</span><span class="pun">(</span><span class="pln">$result</span><span class="pun">))</span><span class="pln"> </span><span class="pun">{</span></code></li><li class="L2"><code class="language-php"><span class="pln"> &nbsp; &nbsp; &nbsp; &nbsp;$posts</span><span class="pun">[]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> $row</span><span class="pun">;</span></code></li><li class="L3"><code class="language-php"><span class="pln"> &nbsp; &nbsp;</span><span class="pun">}</span></code></li><li class="L4"><code class="language-php"><span class="pln"> &nbsp; &nbsp;close_database_connection</span><span class="pun">(</span><span class="pln">$link</span><span class="pun">);</span></code></li><li class="L5"><code class="language-php"></code></li><li class="L6"><code class="language-php"><span class="pln"> &nbsp; &nbsp;</span><span class="kwd">return</span><span class="pln"> $posts</span><span class="pun">;</span></code></li><li class="L7"><code class="language-php"><span class="pun">}</span></code></li></ol></pre><br/><p>&nbsp;&nbsp;&nbsp;&nbsp;文件名<code class="docutils literal"><span style="color: rgb(255, 0, 0);">model.php</span></code>被使用是因为逻辑和数据访问在传统开发中都被称之为模块层!在一个组织良好的程序中,表示商业逻辑的代码应该被放在模块(<code class="docutils literal"><span style="color: rgb(255, 0, 0);">model</span></code>)中(可以将它放在一个控制器(<code class="docutils literal"><span style="color: rgb(255, 0, 0);">controller</span></code>)里面).不同的是,在这个例子中,模块的功能仅仅是用来访问链接数据库.</p><p>&nbsp;&nbsp;&nbsp;&nbsp;这个例子中的控制器的实现(<code class="docutils literal"><span style="color: rgb(255, 0, 0);">index.php</span></code><span style="line-height: 1.6;">)是相当简单的!</span></p><pre class="prettyprint linenums prettyprinted" style=""><ol class="linenums list-paddingleft-2"><li class="L0"><code class="language-php"><span class="pun">&lt;?</span><span class="pln">php</span></code></li><li class="L1"><code class="language-php"><span class="pln">require_once </span><span class="str">&#39;model.php&#39;</span><span class="pun">;</span></code></li><li class="L2"><code class="language-php"></code></li><li class="L3"><code class="language-php"><span class="pln">$posts </span><span class="pun">=</span><span class="pln"> get_all_posts</span><span class="pun">();</span></code></li><li class="L4"><code class="language-php"></code></li><li class="L5"><code class="language-php"><span class="kwd">require</span><span class="pln"> </span><span class="str">&#39;templates/list.php&#39;</span><span class="pun">;</span></code></li></ol></pre><br/><p><span style="line-height: 1.6;">&nbsp;&nbsp;&nbsp;&nbsp;现在,控制器的唯一任务就是从应用的模块层中获取数据,并且调用模板来渲染数据.这是一个非常简单的</span><code class="docutils literal"><span style="color: rgb(255, 0, 0);">model-view-controller</span></code><span style="line-height: 1.6;">模式的示例.</span><br/></p><p><span style="line-height: 1.6;"></span></p><h3><br/></h3><h3>布局分离</h3><p><span style="line-height: 1.6;">&nbsp;&nbsp;&nbsp;&nbsp;在这一点上，应用程序已被重构为三个不同的部分，提供各种优点，并有机会在不同的页面中重用所有代码。</span><br/><span style="line-height: 1.6;"></span></p><p><span style="line-height: 1.6;">&nbsp;&nbsp;&nbsp;&nbsp;唯一不能重复使用的代码部分是页面布局,可以通过新增一个</span><code class="docutils literal"><span style="color: rgb(255, 0, 0);">layout.php</span></code><span style="line-height: 1.6;">文件来弥补:</span></p><p><span style="line-height: 1.6;"></span></p><pre class="prettyprint linenums prettyprinted" style=""><ol class="linenums list-paddingleft-2"><li class="L0"><code class="language-php"><span class="com">&lt;!-- templates/layout.php --&gt;</span></code></li><li class="L1"><code class="language-php"><span class="dec">&lt;!DOCTYPE html&gt;</span></code></li><li class="L2"><code class="language-php"><span class="tag">&lt;html&gt;</span></code></li><li class="L3"><code class="language-php"><span class="pln"> &nbsp; &nbsp;</span><span class="tag">&lt;head&gt;</span></code></li><li class="L4"><code class="language-php"><span class="pln"> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="tag">&lt;title&gt;</span><span class="pun">&lt;?</span><span class="pln">php echo $title </span><span class="pun">?&gt;</span><span class="tag">&lt;/title&gt;</span></code></li><li class="L5"><code class="language-php"><span class="pln"> &nbsp; &nbsp;</span><span class="tag">&lt;/head&gt;</span></code></li><li class="L6"><code class="language-php"><span class="pln"> &nbsp; &nbsp;</span><span class="tag">&lt;body&gt;</span></code></li><li class="L7"><code class="language-php"><span class="pln"> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="pun">&lt;?</span><span class="pln">php echo $content </span><span class="pun">?&gt;</span></code></li><li class="L8"><code class="language-php"><span class="pln"> &nbsp; &nbsp;</span><span class="tag">&lt;/body&gt;</span></code></li><li class="L9"><code class="language-php"><span class="tag">&lt;/html&gt;</span></code></li></ol></pre><p>&nbsp;&nbsp;&nbsp;&nbsp;模板(<code class="docutils literal"><span style="color: rgb(255, 0, 0);">templates/list.php</span></code>)可以简化为一个扩展的布局:</p><p><span style="line-height: 1.6;"></span></p><pre class="prettyprint linenums prettyprinted" style=""><ol class="linenums list-paddingleft-2"><li class="L0"><code class="language-php"><span class="pun">&lt;?</span><span class="pln">php $title </span><span class="pun">=</span><span class="pln"> </span><span class="str">&#39;List of Posts&#39;</span><span class="pln"> </span><span class="pun">?&gt;</span></code></li><li class="L1"><code class="language-php"></code></li><li class="L2"><code class="language-php"><span class="pun">&lt;?</span><span class="pln">php ob_start</span><span class="pun">()</span><span class="pln"> </span><span class="pun">?&gt;</span></code></li><li class="L3"><code class="language-php"><span class="pln"> &nbsp; &nbsp;</span><span class="tag">&lt;h1&gt;</span><span class="pln">List of Posts</span><span class="tag">&lt;/h1&gt;</span></code></li><li class="L4"><code class="language-php"><span class="pln"> &nbsp; &nbsp;</span><span class="tag">&lt;ul&gt;</span></code></li><li class="L5"><code class="language-php"><span class="pln"> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="pun">&lt;?</span><span class="pln">php </span><span class="kwd">foreach</span><span class="pln"> </span><span class="pun">(</span><span class="pln">$posts </span><span class="kwd">as</span><span class="pln"> $post</span><span class="pun">):</span><span class="pln"> </span><span class="pun">?&gt;</span></code></li><li class="L6"><code class="language-php"><span class="pln"> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="tag">&lt;li&gt;</span></code></li><li class="L7"><code class="language-php"><span class="pln"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;a href=&quot;/read?id=</span><span class="pun">&lt;?</span><span class="pln">php echo $post</span><span class="pun">[</span><span class="str">&#39;id&#39;</span><span class="pun">]</span><span class="pln"> </span><span class="pun">?&gt;</span><span class="pln">&quot;&gt;</span></code></li><li class="L8"><code class="language-php"><span class="pln"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="pun">&lt;?</span><span class="pln">php echo $post</span><span class="pun">[</span><span class="str">&#39;title&#39;</span><span class="pun">]</span><span class="pln"> </span><span class="pun">?&gt;</span></code></li><li class="L9"><code class="language-php"><span class="pln"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="tag">&lt;/a&gt;</span></code></li><li class="L0"><code class="language-php"><span class="pln"> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="tag">&lt;/li&gt;</span></code></li><li class="L1"><code class="language-php"><span class="pln"> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="pun">&lt;?</span><span class="pln">php endforeach </span><span class="pun">?&gt;</span></code></li><li class="L2"><code class="language-php"><span class="pln"> &nbsp; &nbsp;</span><span class="tag">&lt;/ul&gt;</span></code></li><li class="L3"><code class="language-php"><span class="pun">&lt;?</span><span class="pln">php $content </span><span class="pun">=</span><span class="pln"> ob_get_clean</span><span class="pun">()</span><span class="pln"> </span><span class="pun">?&gt;</span></code></li><li class="L4"><code class="language-php"></code></li><li class="L5"><code class="language-php"><span class="pun">&lt;?</span><span class="pln">php include </span><span class="str">&#39;layout.php&#39;</span><span class="pln"> </span><span class="pun">?&gt;</span></code></li></ol></pre><br/><p><span style="line-height: 1.6;">&nbsp;&nbsp;&nbsp;&nbsp;你现在已经有了一个完整的程序,并且它允许你去重用的模板.</span></p><p><span style="line-height: 1.6;">&nbsp;&nbsp;&nbsp;&nbsp;不幸的是,要做到这一点，你不得不在模板中使用了一些丑陋的PHP函数（</span><code class="docutils literal"><span style="color: rgb(255, 0, 0);">ob_start(), ob_get_clean()</span></code><span style="line-height: 1.6;">）。Symfony的模板组件可以让你非常简介轻松的实现这一点,弥补原生php的缺陷!你马上就会看到Symfony的威力!!</span></p><p><span style="line-height: 1.6;"></span></p><h2><br/></h2><h2>添加博客”show”页面</h2><p><span style="line-height: 1.6;"></span>&nbsp;&nbsp;&nbsp;&nbsp;博客的展示页面已经被重构,并且代码已经变得组织良好并且重用性很高!现在我们来证明这个问题!添加一个展示(show)页面,用来显示一个根据id查询参数来确定个人博客文章的页面:<br/></p><p>&nbsp;&nbsp;&nbsp;&nbsp;现在开始!在<code class="docutils literal"><span style="color: rgb(255, 0, 0);">model.php</span></code>中创建一个新的函数,用来基于给定的id来检索一个个人博客:<br/></p><pre class="prettyprint linenums prettyprinted" style=""><ol class="linenums list-paddingleft-2"><li class="L0"><code class="language-php"></code></li><li class="L1"><code class="language-php"></code></li><li class="L2"><code class="language-php"><span class="com">// model.php</span></code></li><li class="L3"><code class="language-php"><span class="kwd">function</span><span class="pln"> get_post_by_id</span><span class="pun">(</span><span class="pln">$id</span><span class="pun">)</span></code></li><li class="L4"><code class="language-php"><span class="pun">{</span></code></li><li class="L5"><code class="language-php"><span class="pln"> &nbsp; &nbsp;$link </span><span class="pun">=</span><span class="pln"> open_database_connection</span><span class="pun">();</span></code></li><li class="L6"><code class="language-php"></code></li><li class="L7"><code class="language-php"><span class="pln"> &nbsp; &nbsp;$id </span><span class="pun">=</span><span class="pln"> intval</span><span class="pun">(</span><span class="pln">$id</span><span class="pun">);</span></code></li><li class="L8"><code class="language-php"><span class="pln"> &nbsp; &nbsp;$query </span><span class="pun">=</span><span class="pln"> </span><span class="str">&#39;SELECT date, title, body FROM post WHERE id = &#39;</span><span class="pun">.</span><span class="pln">$id</span><span class="pun">;</span></code></li><li class="L9"><code class="language-php"><span class="pln"> &nbsp; &nbsp;$result </span><span class="pun">=</span><span class="pln"> mysql_query</span><span class="pun">(</span><span class="pln">$query</span><span class="pun">);</span></code></li><li class="L0"><code class="language-php"><span class="pln"> &nbsp; &nbsp;$row </span><span class="pun">=</span><span class="pln"> mysql_fetch_assoc</span><span class="pun">(</span><span class="pln">$result</span><span class="pun">);</span></code></li><li class="L1"><code class="language-php"></code></li><li class="L2"><code class="language-php"><span class="pln"> &nbsp; &nbsp;close_database_connection</span><span class="pun">(</span><span class="pln">$link</span><span class="pun">);</span></code></li><li class="L3"><code class="language-php"></code></li><li class="L4"><code class="language-php"><span class="pln"> &nbsp; &nbsp;</span><span class="kwd">return</span><span class="pln"> $row</span><span class="pun">;</span></code></li><li class="L5"><code class="language-php"><span class="pun">}</span></code></li></ol></pre><p><span style="line-height: 1.6;">&nbsp;&nbsp;&nbsp;&nbsp;现在,创建一个新的文件</span><code class="docutils literal"><span style="color: rgb(255, 0, 0);">show.php</span></code><span style="line-height: 1.6;">,这是这个新的页面的控制器!</span><br/></p><p><span style="line-height: 1.6;"></span></p><pre class="prettyprint linenums prettyprinted" style=""><ol class="linenums list-paddingleft-2"><li class="L0"><code class="language-php"><span class="pun">&lt;?</span><span class="pln">php</span></code></li><li class="L1"><code class="language-php"><span class="pln">require_once </span><span class="str">&#39;model.php&#39;</span><span class="pun">;</span></code></li><li class="L2"><code class="language-php"></code></li><li class="L3"><code class="language-php"><span class="pln">$post </span><span class="pun">=</span><span class="pln"> get_post_by_id</span><span class="pun">(</span><span class="pln">$_GET</span><span class="pun">[</span><span class="str">&#39;id&#39;</span><span class="pun">]);</span></code></li><li class="L4"><code class="language-php"></code></li><li class="L5"><code class="language-php"><span class="kwd">require</span><span class="pln"> </span><span class="str">&#39;templates/show.php&#39;</span><span class="pun">;</span></code></li></ol></pre><p>&nbsp;&nbsp;&nbsp;&nbsp;最后,创建一个模板文件<code class="docutils literal"><span style="color: rgb(255, 0, 0);">templates/show.php</span></code>去渲染个人博客文章:</p><pre class="prettyprint linenums prettyprinted" style=""><ol class="linenums list-paddingleft-2"><li class="L0"><code class="language-php"><span class="pun">&lt;?</span><span class="pln">php $title </span><span class="pun">=</span><span class="pln"> $post</span><span class="pun">[</span><span class="str">&#39;title&#39;</span><span class="pun">]</span><span class="pln"> </span><span class="pun">?&gt;</span></code></li><li class="L1"><code class="language-php"></code></li><li class="L2"><code class="language-php"><span class="pun">&lt;?</span><span class="pln">php ob_start</span><span class="pun">()</span><span class="pln"> </span><span class="pun">?&gt;</span></code></li><li class="L3"><code class="language-php"><span class="pln"> &nbsp; &nbsp;</span><span class="tag">&lt;h1&gt;</span><span class="pun">&lt;?</span><span class="pln">php echo $post</span><span class="pun">[</span><span class="str">&#39;title&#39;</span><span class="pun">]</span><span class="pln"> </span><span class="pun">?&gt;</span><span class="tag">&lt;/h1&gt;</span></code></li><li class="L4"><code class="language-php"></code></li><li class="L5"><code class="language-php"><span class="pln"> &nbsp; &nbsp;</span><span class="tag">&lt;div</span><span class="pln"> </span><span class="atn">class</span><span class="pun">=</span><span class="atv">&quot;date&quot;</span><span class="tag">&gt;</span><span class="pun">&lt;?</span><span class="pln">php echo $post</span><span class="pun">[</span><span class="str">&#39;date&#39;</span><span class="pun">]</span><span class="pln"> </span><span class="pun">?&gt;</span><span class="tag">&lt;/div&gt;</span></code></li><li class="L6"><code class="language-php"><span class="pln"> &nbsp; &nbsp;</span><span class="tag">&lt;div</span><span class="pln"> </span><span class="atn">class</span><span class="pun">=</span><span class="atv">&quot;body&quot;</span><span class="tag">&gt;</span></code></li><li class="L7"><code class="language-php"><span class="pln"> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="pun">&lt;?</span><span class="pln">php echo $post</span><span class="pun">[</span><span class="str">&#39;body&#39;</span><span class="pun">]</span><span class="pln"> </span><span class="pun">?&gt;</span></code></li><li class="L8"><code class="language-php"><span class="pln"> &nbsp; &nbsp;</span><span class="tag">&lt;/div&gt;</span></code></li><li class="L9"><code class="language-php"><span class="pun">&lt;?</span><span class="pln">php $content </span><span class="pun">=</span><span class="pln"> ob_get_clean</span><span class="pun">()</span><span class="pln"> </span><span class="pun">?&gt;</span></code></li><li class="L0"><code class="language-php"></code></li><li class="L1"><code class="language-php"><span class="pun">&lt;?</span><span class="pln">php include </span><span class="str">&#39;layout.php&#39;</span><span class="pln"> </span><span class="pun">?&gt;</span></code></li></ol></pre><br/><p><span style="line-height: 1.6;">&nbsp;&nbsp;&nbsp;&nbsp;创建第二个页面是非常容易的,这期间没有任何的代码复制!</span><span style="line-height: 27px;">不过，这里介绍了一个更加挥之不去的问题,可以使用一个框架完美的解决他。</span><span style="line-height: 27px;">例如，丢失或无效的ID查询参数会导致页面崩溃。一中更好地方式是渲染并返回一个404页面,但是要想做到这个这确是相当不容易的! 更糟糕的是,你可能已经忘记去使用</span><code class="docutils literal"><span style="color: rgb(255, 0, 0);">intval()</span></code><span style="line-height: 27px;">函数来清除id查询参数里面的非法字符,你的站点入口的数据库链接很有可能会遭受sql注入攻击!</span></p><p><span style="line-height: 27px;">&nbsp;&nbsp;&nbsp;&nbsp;还有一个主要问题就是&nbsp;个人的控制器必须被包含在</span><code class="docutils literal"><span style="color: rgb(255, 0, 0);">model.php</span></code><span style="line-height: 27px;">文件里.如果每一个控制器都需要包含一个其他的文件,并且作为一个全局的任务去执行会怎莫样呢?这安全吗?&nbsp; 目前的情况是,代码需要被添加到每一个控制器文件里面,如果你忘记添加一些东西到一个文件里面,希望这不涉及到安全性! &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span></p>
 <h2><br/></h2><h2>“Front Controller”解决方案</h2><p>&nbsp;&nbsp;&nbsp;&nbsp;一个简单的解决方案就是使用一个前端控制器,用它来处理所有的请求.&nbsp;&nbsp;<span style="font-family: Arial; line-height: 27px;">随着前端控制器加入，这些URI应用程序略有变化，但开始变得更加灵活：</span></p><p><span style="font-family: Arial; line-height: 27px;"></span></p><pre class="prettyprint linenums prettyprinted" style=""><ol class="linenums list-paddingleft-2"><li class="L0"><code class="language-php"><span class="typ">Without</span><span class="pln"> a front controller</span></code></li><li class="L1"><code class="language-php"><span class="pun">/</span><span class="pln">index</span><span class="pun">.</span><span class="pln">php &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="pun">=&gt;</span><span class="pln"> </span><span class="typ">Blog</span><span class="pln"> post list page </span><span class="pun">(</span><span class="pln">index</span><span class="pun">.</span><span class="pln">php executed</span><span class="pun">)</span></code></li><li class="L2"><code class="language-php"><span class="pun">/</span><span class="pln">show</span><span class="pun">.</span><span class="pln">php &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">=&gt;</span><span class="pln"> </span><span class="typ">Blog</span><span class="pln"> post show page </span><span class="pun">(</span><span class="pln">show</span><span class="pun">.</span><span class="pln">php executed</span><span class="pun">)</span></code></li><li class="L3"><code class="language-php"></code></li><li class="L4"><code class="language-php"><span class="typ">With</span><span class="pln"> index</span><span class="pun">.</span><span class="pln">php </span><span class="kwd">as</span><span class="pln"> the front controller</span></code></li><li class="L5"><code class="language-php"><span class="pun">/</span><span class="pln">index</span><span class="pun">.</span><span class="pln">php &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="pun">=&gt;</span><span class="pln"> </span><span class="typ">Blog</span><span class="pln"> post list page </span><span class="pun">(</span><span class="pln">index</span><span class="pun">.</span><span class="pln">php executed</span><span class="pun">)</span></code></li><li class="L6"><code class="language-php"><span class="pun">/</span><span class="pln">index</span><span class="pun">.</span><span class="pln">php</span><span class="pun">/</span><span class="pln">show &nbsp; &nbsp; </span><span class="pun">=&gt;</span><span class="pln"> </span><span class="typ">Blog</span><span class="pln"> post show page </span><span class="pun">(</span><span class="pln">index</span><span class="pun">.</span><span class="pln">php executed</span><span class="pun">)</span></code></li></ol></pre><p>&nbsp;&nbsp;&nbsp;&nbsp;当使用一个前端控制器时,一个简单的php文件(<code class="docutils literal"><span style="color: rgb(255, 0, 0);">index.php</span></code>)将处理每一个请求,对于博客文章展示页面,<code class="docutils literal"><span style="color: rgb(255, 0, 0);">/index.php/show</span></code>将会执行<code class="docutils literal"><span style="color: rgb(255, 0, 0);">index.php</span></code>文件,这个文件将基于内部的url来充分的处理每一个路由请求.正如你所看到的,一个前段控制器是一个强有力的工具.</p><h3><br/></h3><h3>创建Front Controller</h3><p>&nbsp;&nbsp;&nbsp;&nbsp;自此以后,你将在应用程序开发上迈出巨大的一步!!通过路由所有的请求,你可以集中精力于一些事情,如安全处理,配置加载,以及路由!在这个应用程序中,<code class="docutils literal"><span style="color: rgb(255, 0, 0);">index.php</span></code>必须能够智能的根据请求的链接来渲染博客文章展示页面:<br/></p><pre class="prettyprint linenums prettyprinted" style=""><ol class="linenums list-paddingleft-2"><li class="L0"><code class="language-php"><span class="pun">&lt;?</span><span class="pln">php</span></code></li><li class="L1"><code class="language-php"><span class="com">// index.php</span></code></li><li class="L2"><code class="language-php"></code></li><li class="L3"><code class="language-php"><span class="com">// load and initialize any global libraries</span></code></li><li class="L4"><code class="language-php"><span class="pln">require_once </span><span class="str">&#39;model.php&#39;</span><span class="pun">;</span></code></li><li class="L5"><code class="language-php"><span class="pln">require_once </span><span class="str">&#39;controllers.php&#39;</span><span class="pun">;</span></code></li><li class="L6"><code class="language-php"></code></li><li class="L7"><code class="language-php"><span class="com">// route the request internally</span></code></li><li class="L8"><code class="language-php"><span class="pln">$uri </span><span class="pun">=</span><span class="pln"> parse_url</span><span class="pun">(</span><span class="pln">$_SERVER</span><span class="pun">[</span><span class="str">&#39;REQUEST_URI&#39;</span><span class="pun">],</span><span class="pln"> PHP_URL_PATH</span><span class="pun">);</span></code></li><li class="L9"><code class="language-php"><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="str">&#39;/index.php&#39;</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> $uri</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span></code></li><li class="L0"><code class="language-php"><span class="pln"> &nbsp; &nbsp;list_action</span><span class="pun">();</span></code></li><li class="L1"><code class="language-php"><span class="pun">}</span><span class="pln"> elseif </span><span class="pun">(</span><span class="str">&#39;/index.php/show&#39;</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> $uri </span><span class="pun">&amp;&amp;</span><span class="pln"> isset</span><span class="pun">(</span><span class="pln">$_GET</span><span class="pun">[</span><span class="str">&#39;id&#39;</span><span class="pun">]))</span><span class="pln"> </span><span class="pun">{</span></code></li><li class="L2"><code class="language-php"><span class="pln"> &nbsp; &nbsp;show_action</span><span class="pun">(</span><span class="pln">$_GET</span><span class="pun">[</span><span class="str">&#39;id&#39;</span><span class="pun">]);</span></code></li><li class="L3"><code class="language-php"><span class="pun">}</span><span class="pln"> </span><span class="kwd">else</span><span class="pln"> </span><span class="pun">{</span></code></li><li class="L4"><code class="language-php"><span class="pln"> &nbsp; &nbsp;header</span><span class="pun">(</span><span class="str">&#39;Status: 404 Not Found&#39;</span><span class="pun">);</span></code></li><li class="L5"><code class="language-php"><span class="pln"> &nbsp; &nbsp;echo </span><span class="str">&#39;&lt;html&gt;&lt;body&gt;&lt;h1&gt;Page Not Found&lt;/h1&gt;&lt;/body&gt;&lt;/html&gt;&#39;</span><span class="pun">;</span></code></li><li class="L6"><code class="language-php"><span class="pun">}</span></code></li></ol></pre><br/><p><span style="font-family: Arial; line-height: 27px;">&nbsp;&nbsp;&nbsp;&nbsp;为了让程序更加的有组织,我们将</span><code class="docutils literal"><span style="color: rgb(255, 0, 0);">index.php</span></code><span style="font-family: Arial; line-height: 27px;">&nbsp;和&nbsp;</span><code class="docutils literal"><span style="color: rgb(255, 0, 0);">show.php</span></code><span style="font-family: Arial; line-height: 27px;">里的控制器函数每一个都移动到一个分离的文件</span><code class="docutils literal"><span style="color: rgb(255, 0, 0);">controllers.php</span></code><span style="font-family: Arial; line-height: 27px;">中:<br/></span></p><p><span style="font-family: Arial; line-height: 27px;"></span></p><pre class="prettyprint linenums prettyprinted" style=""><ol class="linenums list-paddingleft-2"><li class="L0"><code class="language-php"><span class="kwd">function</span><span class="pln"> list_action</span><span class="pun">()</span></code></li><li class="L1"><code class="language-php"><span class="pun">{</span></code></li><li class="L2"><code class="language-php"><span class="pln"> &nbsp; &nbsp;$posts </span><span class="pun">=</span><span class="pln"> get_all_posts</span><span class="pun">();</span></code></li><li class="L3"><code class="language-php"><span class="pln"> &nbsp; &nbsp;</span><span class="kwd">require</span><span class="pln"> </span><span class="str">&#39;templates/list.php&#39;</span><span class="pun">;</span></code></li><li class="L4"><code class="language-php"><span class="pun">}</span></code></li><li class="L5"><code class="language-php"></code></li><li class="L6"><code class="language-php"><span class="kwd">function</span><span class="pln"> show_action</span><span class="pun">(</span><span class="pln">$id</span><span class="pun">)</span></code></li><li class="L7"><code class="language-php"><span class="pun">{</span></code></li><li class="L8"><code class="language-php"><span class="pln"> &nbsp; &nbsp;$post </span><span class="pun">=</span><span class="pln"> get_post_by_id</span><span class="pun">(</span><span class="pln">$id</span><span class="pun">);</span></code></li><li class="L9"><code class="language-php"><span class="pln"> &nbsp; &nbsp;</span><span class="kwd">require</span><span class="pln"> </span><span class="str">&#39;templates/show.php&#39;</span><span class="pun">;</span></code></li><li class="L0"><code class="language-php"><span class="pun">}</span></code></li></ol></pre><p>&nbsp;&nbsp;&nbsp;&nbsp;作为前段控制器,<code class="docutils literal"><span style="color: rgb(255, 0, 0);">index.php</span></code>已经扮演了一个全新的角色,它为了让两个控制器函数(<code class="docutils literal"><span style="color: rgb(255, 0, 0);">list_action()</span></code>&nbsp;和&nbsp;<code class="docutils literal"><span style="color: rgb(255, 0, 0);">show_action()</span></code>)被调用载入了所有的核心库并且路由整个应用程序,这看起来和Symfony的机制越来越像了.</p><p>&nbsp;&nbsp;&nbsp;&nbsp;前端控制器的另一优点是灵活的网址<code class="docutils literal"><span style="color: rgb(255, 0, 0);">URLs</span></code>,注意,这个博客文章展示页只能在一个位置被改变,在此之前,一个入口文件必须要被重定义!在Symfony中,这个入口文章将变得更加灵活!</p><p>&nbsp;&nbsp;&nbsp;&nbsp;到目前为止,整个应用已经由简单的<code class="docutils literal"><span style="color: rgb(255, 0, 0);">php</span></code>文件被转换为一个有组织性,代码可重用的一个结构.你现在应该很开心了,但是先等等,高兴的有点儿早了.当前还有很多问题.例如,路由系统是很无情的,他并不会通过<code class="docutils literal"><span style="color: rgb(255, 0, 0);">/</span></code>(如果<code class="docutils literal"><span style="color: rgb(255, 0, 0);">apache rewrite</span></code> 拟静态规则被添加)来识别那些列表页(<code class="docutils literal"><span style="color: rgb(255, 0, 0);">/index.php</span></code>),同样,如果开发的不是博客,那末大量的时间将会被花费在系统的代码架构上(例如:路由,如何调用控制器,模板渲染等)!更多的时间将会花费在处理表单提交,输入验证,数据记录,以及系统安全性上.为甚麽你要去为这些常规的问题去发明解决方案呢?</p><h3><br/></h3><h3>初识Symfony</h3><p>&nbsp;&nbsp;&nbsp;&nbsp;Symfony是可以被重用的,在使用symfony之前,你需要去下载它!它可以通过<code class="docutils literal"><span style="color: rgb(255, 0, 0);">Composer</span></code>(它负责下载正确的版本和所有的依赖关系，并提供了自动加载机制)来获取.<code class="docutils literal"><span style="color: rgb(255, 0, 0);">Composer</span></code>作为一个自动加载工具,她让在使用php而无须在意是否明确包含一些依赖文件成为可能!</p><p>&nbsp;&nbsp;&nbsp;&nbsp;在你的根目录,创建一个<code class="docutils literal"><span style="color: rgb(255, 0, 0);">composer.json</span></code>文件并写入如下内容:<br/></p><p></p><pre class="prettyprint linenums prettyprinted" style=""><code class="language-php"></code><code class="language-php"></code><ol class="linenums list-paddingleft-2"><li class="L2"><code class="language-php"><span class="pun">{</span></code></li><li class="L3"><code class="language-php"><span class="pln"> &nbsp; &nbsp;</span><span class="str">&quot;require&quot;</span><span class="pun">:</span><span class="pln"> </span><span class="pun">{</span></code></li><li class="L4"><code class="language-php"><span class="pln"> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="str">&quot;symfony/symfony&quot;</span><span class="pun">:</span><span class="pln"> </span><span class="str">&quot;2.6.*&quot;</span></code></li><li class="L5"><code class="language-php"><span class="pln"> &nbsp; &nbsp;</span><span class="pun">},</span></code></li><li class="L6"><code class="language-php"><span class="pln"> &nbsp; &nbsp;</span><span class="str">&quot;autoload&quot;</span><span class="pun">:</span><span class="pln"> </span><span class="pun">{</span></code></li><li class="L7"><code class="language-php"><span class="pln"> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="str">&quot;files&quot;</span><span class="pun">:</span><span class="pln"> </span><span class="pun">[</span><span class="str">&quot;model.php&quot;</span><span class="pun">,</span><span class="str">&quot;controllers.php&quot;</span><span class="pun">]</span></code></li><li class="L8"><code class="language-php"><span class="pln"> &nbsp; &nbsp;</span><span class="pun">}</span></code></li><li class="L9"><code class="language-php"><span class="pun">}</span></code></li></ol></pre><p>&nbsp;&nbsp;&nbsp;&nbsp;接下来,下载<a class="reference external" href="http://getcomposer.org/download/">Composer</a>&nbsp;并且运行如下命令,他将会将Symfony下载到<code class="docutils literal"><span style="color: rgb(255, 0, 0);">vendor/</span></code>目录下:</p><pre class="prettyprint linenums prettyprinted" style=""><ol class="linenums list-paddingleft-2"><li class="L0"><code class="language-php"><span class="pln">$ composer install</span></code></li></ol></pre><p>&nbsp;&nbsp;&nbsp;&nbsp;除了下载你需要的依赖包以外,<code class="docutils literal"><span style="color: rgb(255, 0, 0);">Composer</span></code>还会创建一个<code class="docutils literal"><span style="color: rgb(255, 0, 0);">vendor/autoload.php</span></code>文件,它用来处理在Symfony框架中所有文件的自动载入以及自动加载在<code class="docutils literal"><span style="color: rgb(255, 0, 0);">composer.json</span></code>中提到的文件.<br/></p><p>&nbsp;&nbsp;&nbsp;&nbsp;Symfony的核心理念就是去由应用程序去解释,每一个请求并且返回一个响应.为此,Symfony提供了一个<a class="reference external" href="http://api.symfony.com/master/Symfony/Component/HttpFoundation/Request.html" title="Symfony\Component\HttpFoundation\Request"><code class="docutils literal"><span style="color: rgb(255, 0, 0);">Request</span></code></a><code class="docutils literal"><span class="pre">&nbsp;和&nbsp;</span></code><a class="reference external" href="http://api.symfony.com/master/Symfony/Component/HttpFoundation/Response.html" title="Symfony\Component\HttpFoundation\Response"><code class="docutils literal"><span style="color: rgb(255, 0, 0);">Response</span></code></a><code class="docutils literal"><span class="pre"><code class="docutils literal"><span class="pre">&nbsp;类,这些类是用于做原生</span></code></span></code><code class="docutils literal"><span style="color: rgb(255, 0, 0);">http</span></code><code class="docutils literal"><span class="pre"><code class="docutils literal"><span class="pre">解析和响应的面向对象的封装,用他们可以进一步的提升我们的blog应用:</span></code></span></code></p><p></p><pre class="prettyprint linenums prettyprinted" style=""><ol class="linenums list-paddingleft-2"><li class="L0"><code class="language-php"><span class="pun">&lt;?</span><span class="pln">php</span></code></li><li class="L1"><code class="language-php"><span class="com">// index.php</span></code></li><li class="L2"><code class="language-php"><span class="pln">require_once </span><span class="str">&#39;vendor/autoload.php&#39;</span><span class="pun">;</span></code></li><li class="L3"><code class="language-php"></code></li><li class="L4"><code class="language-php"><span class="kwd">use</span><span class="pln"> </span><span class="typ">Symfony</span><span class="pln">\Component\HttpFoundation\Request</span><span class="pun">;</span></code></li><li class="L5"><code class="language-php"><span class="kwd">use</span><span class="pln"> </span><span class="typ">Symfony</span><span class="pln">\Component\HttpFoundation\Response</span><span class="pun">;</span></code></li><li class="L6"><code class="language-php"></code></li><li class="L7"><code class="language-php"><span class="pln">$request </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Request</span><span class="pun">::</span><span class="pln">createFromGlobals</span><span class="pun">();</span></code></li><li class="L8"><code class="language-php"></code></li><li class="L9"><code class="language-php"><span class="pln">$uri </span><span class="pun">=</span><span class="pln"> $request</span><span class="pun">-&gt;</span><span class="pln">getPathInfo</span><span class="pun">();</span></code></li><li class="L0"><code class="language-php"><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="str">&#39;/&#39;</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> $uri</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span></code></li><li class="L1"><code class="language-php"><span class="pln"> &nbsp; &nbsp;$response </span><span class="pun">=</span><span class="pln"> list_action</span><span class="pun">();</span></code></li><li class="L2"><code class="language-php"><span class="pun">}</span><span class="pln"> elseif </span><span class="pun">(</span><span class="str">&#39;/show&#39;</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> $uri </span><span class="pun">&amp;&amp;</span><span class="pln"> $request</span><span class="pun">-&gt;</span><span class="pln">query</span><span class="pun">-&gt;</span><span class="pln">has</span><span class="pun">(</span><span class="str">&#39;id&#39;</span><span class="pun">))</span><span class="pln"> </span><span class="pun">{</span></code></li><li class="L3"><code class="language-php"><span class="pln"> &nbsp; &nbsp;$response </span><span class="pun">=</span><span class="pln"> show_action</span><span class="pun">(</span><span class="pln">$request</span><span class="pun">-&gt;</span><span class="pln">query</span><span class="pun">-&gt;</span><span class="kwd">get</span><span class="pun">(</span><span class="str">&#39;id&#39;</span><span class="pun">));</span></code></li><li class="L4"><code class="language-php"><span class="pun">}</span><span class="pln"> </span><span class="kwd">else</span><span class="pln"> </span><span class="pun">{</span></code></li><li class="L5"><code class="language-php"><span class="pln"> &nbsp; &nbsp;$html </span><span class="pun">=</span><span class="pln"> </span><span class="str">&#39;&lt;html&gt;&lt;body&gt;&lt;h1&gt;Page Not Found&lt;/h1&gt;&lt;/body&gt;&lt;/html&gt;&#39;</span><span class="pun">;</span></code></li><li class="L6"><code class="language-php"><span class="pln"> &nbsp; &nbsp;$response </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">Response</span><span class="pun">(</span><span class="pln">$html</span><span class="pun">,</span><span class="pln"> </span><span class="typ">Response</span><span class="pun">::</span><span class="pln">HTTP_NOT_FOUND</span><span class="pun">);</span></code></li><li class="L7"><code class="language-php"><span class="pun">}</span></code></li><li class="L8"><code class="language-php"></code></li><li class="L9"><code class="language-php"><span class="com">// echo the headers and send the response</span></code></li><li class="L0"><code class="language-php"><span class="pln">$response</span><span class="pun">-&gt;</span><span class="pln">send</span><span class="pun">();</span></code></li></ol></pre><p><br/></p><p>&nbsp;&nbsp;&nbsp;&nbsp;现在,控制器负责返回<code class="docutils literal"><span style="color: rgb(255, 0, 0);">Response</span></code>对象,为了更为便捷,你可以使用一个<code class="docutils literal"><span style="color: rgb(255, 0, 0);">render_template()</span></code>函数,它的行为颇有点像Symfony的模板引擎:<br/></p><p></p><pre class="prettyprint linenums prettyprinted" style=""><ol class="linenums list-paddingleft-2"><li class="L0"><code class="language-php"><span class="com">// controllers.php</span></code></li><li class="L1"><code class="language-php"><span class="kwd">use</span><span class="pln"> </span><span class="typ">Symfony</span><span class="pln">\Component\HttpFoundation\Response</span><span class="pun">;</span></code></li><li class="L2"><code class="language-php"></code></li><li class="L3"><code class="language-php"><span class="kwd">function</span><span class="pln"> list_action</span><span class="pun">()</span></code></li><li class="L4"><code class="language-php"><span class="pun">{</span></code></li><li class="L5"><code class="language-php"><span class="pln"> &nbsp; &nbsp;$posts </span><span class="pun">=</span><span class="pln"> get_all_posts</span><span class="pun">();</span></code></li><li class="L6"><code class="language-php"><span class="pln"> &nbsp; &nbsp;$html </span><span class="pun">=</span><span class="pln"> render_template</span><span class="pun">(</span><span class="str">&#39;templates/list.php&#39;</span><span class="pun">,</span><span class="pln"> array</span><span class="pun">(</span><span class="str">&#39;posts&#39;</span><span class="pln"> </span><span class="pun">=&gt;</span><span class="pln"> $posts</span><span class="pun">));</span></code></li><li class="L7"><code class="language-php"></code></li><li class="L8"><code class="language-php"><span class="pln"> &nbsp; &nbsp;</span><span class="kwd">return</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">Response</span><span class="pun">(</span><span class="pln">$html</span><span class="pun">);</span></code></li><li class="L9"><code class="language-php"><span class="pun">}</span></code></li><li class="L0"><code class="language-php"></code></li><li class="L1"><code class="language-php"><span class="kwd">function</span><span class="pln"> show_action</span><span class="pun">(</span><span class="pln">$id</span><span class="pun">)</span></code></li><li class="L2"><code class="language-php"><span class="pun">{</span></code></li><li class="L3"><code class="language-php"><span class="pln"> &nbsp; &nbsp;$post </span><span class="pun">=</span><span class="pln"> get_post_by_id</span><span class="pun">(</span><span class="pln">$id</span><span class="pun">);</span></code></li><li class="L4"><code class="language-php"><span class="pln"> &nbsp; &nbsp;$html </span><span class="pun">=</span><span class="pln"> render_template</span><span class="pun">(</span><span class="str">&#39;templates/show.php&#39;</span><span class="pun">,</span><span class="pln"> array</span><span class="pun">(</span><span class="str">&#39;post&#39;</span><span class="pln"> </span><span class="pun">=&gt;</span><span class="pln"> $post</span><span class="pun">));</span></code></li><li class="L5"><code class="language-php"></code></li><li class="L6"><code class="language-php"><span class="pln"> &nbsp; &nbsp;</span><span class="kwd">return</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">Response</span><span class="pun">(</span><span class="pln">$html</span><span class="pun">);</span></code></li><li class="L7"><code class="language-php"><span class="pun">}</span></code></li><li class="L8"><code class="language-php"></code></li><li class="L9"><code class="language-php"><span class="com">// helper function to render templates</span></code></li><li class="L0"><code class="language-php"><span class="kwd">function</span><span class="pln"> render_template</span><span class="pun">(</span><span class="pln">$path</span><span class="pun">,</span><span class="pln"> array $args</span><span class="pun">)</span></code></li><li class="L1"><code class="language-php"><span class="pun">{</span></code></li><li class="L2"><code class="language-php"><span class="pln"> &nbsp; &nbsp;extract</span><span class="pun">(</span><span class="pln">$args</span><span class="pun">);</span></code></li><li class="L3"><code class="language-php"><span class="pln"> &nbsp; &nbsp;ob_start</span><span class="pun">();</span></code></li><li class="L4"><code class="language-php"><span class="pln"> &nbsp; &nbsp;</span><span class="kwd">require</span><span class="pln"> $path</span><span class="pun">;</span></code></li><li class="L5"><code class="language-php"><span class="pln"> &nbsp; &nbsp;$html </span><span class="pun">=</span><span class="pln"> ob_get_clean</span><span class="pun">();</span></code></li><li class="L6"><code class="language-php"></code></li><li class="L7"><code class="language-php"><span class="pln"> &nbsp; &nbsp;</span><span class="kwd">return</span><span class="pln"> $html</span><span class="pun">;</span></code></li><li class="L8"><code class="language-php"><span class="pun">}</span></code></li></ol></pre><br/><p>&nbsp;&nbsp;&nbsp;&nbsp;显而易见,通过Symfony的一小部分,程序已经变的相当灵活可靠了!<code class="docutils literal"><span style="color: rgb(255, 0, 0);">Request</span></code>类提供了一个可信的方式去访问信息通过http请求.更为特别的是,可以通过<code class="docutils literal"><span style="color: rgb(255, 0, 0);">getPathInfo()</span></code>方法来返回一个干净的url(通常是类似于<code class="docutils literal"><span style="color: rgb(255, 0, 0);">/show</span></code>,但绝不是<code class="docutils literal"><span style="color: rgb(255, 0, 0);">/index.php/show</span></code>).所以,及时用户使用<code class="docutils literal"><span style="color: rgb(255, 0, 0);">/index.php/show</span></code>来访问,应用也是相当智能的,,他完全可以通过<code class="docutils literal"><span style="color: rgb(255, 0, 0);">show_action()</span></code>来路由请求.<br/></p><p>&nbsp; &nbsp; &nbsp; &nbsp;<code class="docutils literal"><span style="color: rgb(255, 0, 0);">Response</span></code>类在构建htto响应的时候给予了用户一种灵活性,它允许<code class="docutils literal"><span style="color: rgb(255, 0, 0);">http</span></code>报头和内容通过面向对象的接口被添加到对象中.这个应用程序中的响应是相当简单的,这种灵活性将会随着你的应用程序的增长 变得更加显著!</p><h3><br/></h3><h3>Symfony简单示例</h3><p>&nbsp;&nbsp;&nbsp;&nbsp;我们已经带着这个blog应用走出很长的一段路了,但是就这样一个简单的程序,他仍然包含了大量的代码.<span style="line-height: 1.6;">&nbsp;你已经实现了一个简单的路由系统并且使用</span><code class="docutils literal"><span style="color: rgb(255, 0, 0);">ob_start()</span></code><span style="line-height: 1.6;">&nbsp;和&nbsp;</span><code class="docutils literal"><span style="color: rgb(255, 0, 0);">ob_get_clean()</span></code><span style="line-height: 1.6;">来 渲染模板.如果因为一些原因,你可能需要重头开始构建这个框架,你已经使用了 Symfony的独立路由和模板机制这些已经解决了这个问题.</span></p><p><span style="line-height: 1.6;">&nbsp;&nbsp;&nbsp;&nbsp;对于这些常见问题,你可以让symfony为你关注他们.这里有一个示例程序,现在你可以通过symfony来构建他:</span></p><p><span style="line-height: 1.6;"></span></p><pre class="prettyprint linenums prettyprinted" style=""><ol class="linenums list-paddingleft-2"><li class="L0"><code class="language-php"><span class="com">// src/AppBundle/Controller/BlogController.php</span></code></li><li class="L1"><code class="language-php"><span class="kwd">namespace</span><span class="pln"> </span><span class="typ">AppBundle</span><span class="pln">\Controller</span><span class="pun">;</span></code></li><li class="L2"><code class="language-php"></code></li><li class="L3"><code class="language-php"><span class="kwd">use</span><span class="pln"> </span><span class="typ">Symfony</span><span class="pln">\Bundle\FrameworkBundle\Controller\Controller</span><span class="pun">;</span></code></li><li class="L4"><code class="language-php"></code></li><li class="L5"><code class="language-php"><span class="kwd">class</span><span class="pln"> </span><span class="typ">BlogController</span><span class="pln"> </span><span class="kwd">extends</span><span class="pln"> </span><span class="typ">Controller</span></code></li><li class="L6"><code class="language-php"><span class="pun">{</span></code></li><li class="L7"><code class="language-php"><span class="pln"> &nbsp; &nbsp;</span><span class="kwd">public</span><span class="pln"> </span><span class="kwd">function</span><span class="pln"> listAction</span><span class="pun">()</span></code></li><li class="L8"><code class="language-php"><span class="pln"> &nbsp; &nbsp;</span><span class="pun">{</span></code></li><li class="L9"><code class="language-php"><span class="pln"> &nbsp; &nbsp; &nbsp; &nbsp;$posts </span><span class="pun">=</span><span class="pln"> $this</span><span class="pun">-&gt;</span><span class="kwd">get</span><span class="pun">(</span><span class="str">&#39;doctrine&#39;</span><span class="pun">)</span></code></li><li class="L0"><code class="language-php"><span class="pln"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="pun">-&gt;</span><span class="pln">getManager</span><span class="pun">()</span></code></li><li class="L1"><code class="language-php"><span class="pln"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="pun">-&gt;</span><span class="pln">createQuery</span><span class="pun">(</span><span class="str">&#39;SELECT p FROM AcmeBlogBundle:Post p&#39;</span><span class="pun">)</span></code></li><li class="L2"><code class="language-php"><span class="pln"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="pun">-&gt;</span><span class="pln">execute</span><span class="pun">();</span></code></li><li class="L3"><code class="language-php"></code></li><li class="L4"><code class="language-php"><span class="pln"> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="kwd">return</span><span class="pln"> $this</span><span class="pun">-&gt;</span><span class="pln">render</span><span class="pun">(</span><span class="str">&#39;Blog/list.html.php&#39;</span><span class="pun">,</span><span class="pln"> array</span><span class="pun">(</span><span class="str">&#39;posts&#39;</span><span class="pln"> </span><span class="pun">=&gt;</span><span class="pln"> $posts</span><span class="pun">));</span></code></li><li class="L5"><code class="language-php"><span class="pln"> &nbsp; &nbsp;</span><span class="pun">}</span></code></li><li class="L6"><code class="language-php"></code></li><li class="L7"><code class="language-php"><span class="pln"> &nbsp; &nbsp;</span><span class="kwd">public</span><span class="pln"> </span><span class="kwd">function</span><span class="pln"> showAction</span><span class="pun">(</span><span class="pln">$id</span><span class="pun">)</span></code></li><li class="L8"><code class="language-php"><span class="pln"> &nbsp; &nbsp;</span><span class="pun">{</span></code></li><li class="L9"><code class="language-php"><span class="pln"> &nbsp; &nbsp; &nbsp; &nbsp;$post </span><span class="pun">=</span><span class="pln"> $this</span><span class="pun">-&gt;</span><span class="kwd">get</span><span class="pun">(</span><span class="str">&#39;doctrine&#39;</span><span class="pun">)</span></code></li><li class="L0"><code class="language-php"><span class="pln"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="pun">-&gt;</span><span class="pln">getManager</span><span class="pun">()</span></code></li><li class="L1"><code class="language-php"><span class="pln"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="pun">-&gt;</span><span class="pln">getRepository</span><span class="pun">(</span><span class="str">&#39;AppBundle:Post&#39;</span><span class="pun">)</span></code></li><li class="L2"><code class="language-php"><span class="pln"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="pun">-&gt;</span><span class="pln">find</span><span class="pun">(</span><span class="pln">$id</span><span class="pun">);</span></code></li><li class="L3"><code class="language-php"></code></li><li class="L4"><code class="language-php"><span class="pln"> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(!</span><span class="pln">$post</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span></code></li><li class="L5"><code class="language-php"><span class="pln"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="com">// cause the 404 page not found to be displayed</span></code></li><li class="L6"><code class="language-php"><span class="pln"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="kwd">throw</span><span class="pln"> $this</span><span class="pun">-&gt;</span><span class="pln">createNotFoundException</span><span class="pun">();</span></code></li><li class="L7"><code class="language-php"><span class="pln"> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="pun">}</span></code></li><li class="L8"><code class="language-php"></code></li><li class="L9"><code class="language-php"><span class="pln"> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="kwd">return</span><span class="pln"> $this</span><span class="pun">-&gt;</span><span class="pln">render</span><span class="pun">(</span><span class="str">&#39;Blog/show.html.php&#39;</span><span class="pun">,</span><span class="pln"> array</span><span class="pun">(</span><span class="str">&#39;post&#39;</span><span class="pln"> </span><span class="pun">=&gt;</span><span class="pln"> $post</span><span class="pun">));</span></code></li><li class="L0"><code class="language-php"><span class="pln"> &nbsp; &nbsp;</span><span class="pun">}</span></code></li><li class="L1"><code class="language-php"><span class="pun">}</span></code></li></ol></pre><p id="result" style="margin-top: 0px; margin-bottom: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;这两个控制器仍然是轻量级的,他们每一个都用<a class="reference internal" href="http://symfony.cn/docs/book/doctrine.html"><code class="docutils literal"><span style="color: rgb(255, 0, 0);">Doctrine ORM library</span></code></a>&nbsp;来丛数据库检索对象,使用模板组件来渲染模板,以及返回一个<code class="docutils literal"><span style="color: rgb(255, 0, 0);">Response</span></code>对象, &nbsp;该列表模板现在要简单一些:<span style="line-height: 1.6;">&nbsp; &nbsp; &nbsp; &nbsp;</span></p><pre class="prettyprint linenums prettyprinted" style=""><ol class="linenums list-paddingleft-2"><li class="L0"><code class="language-php"><span class="com">&lt;!-- app/Resources/views/Blog/list.html.php --&gt;</span></code></li><li class="L1"><code class="language-php"><span class="pun">&lt;?</span><span class="pln">php $view</span><span class="pun">-&gt;</span><span class="pln">extend</span><span class="pun">(</span><span class="str">&#39;layout.html.php&#39;</span><span class="pun">)</span><span class="pln"> </span><span class="pun">?&gt;</span></code></li><li class="L2"><code class="language-php"></code></li><li class="L3"><code class="language-php"><span class="pun">&lt;?</span><span class="pln">php $view</span><span class="pun">[</span><span class="str">&#39;slots&#39;</span><span class="pun">]-&gt;</span><span class="kwd">set</span><span class="pun">(</span><span class="str">&#39;title&#39;</span><span class="pun">,</span><span class="pln"> </span><span class="str">&#39;List of Posts&#39;</span><span class="pun">)</span><span class="pln"> </span><span class="pun">?&gt;</span></code></li><li class="L4"><code class="language-php"></code></li><li class="L5"><code class="language-php"><span class="tag">&lt;h1&gt;</span><span class="pln">List of Posts</span><span class="tag">&lt;/h1&gt;</span></code></li><li class="L6"><code class="language-php"><span class="tag">&lt;ul&gt;</span></code></li><li class="L7"><code class="language-php"><span class="pln"> &nbsp; &nbsp;</span><span class="pun">&lt;?</span><span class="pln">php </span><span class="kwd">foreach</span><span class="pln"> </span><span class="pun">(</span><span class="pln">$posts </span><span class="kwd">as</span><span class="pln"> $post</span><span class="pun">):</span><span class="pln"> </span><span class="pun">?&gt;</span></code></li><li class="L8"><code class="language-php"><span class="pln"> &nbsp; &nbsp;</span><span class="tag">&lt;li&gt;</span></code></li><li class="L9"><code class="language-php"><span class="pln"> &nbsp; &nbsp; &nbsp; &nbsp;&lt;a href=&quot;</span><span class="pun">&lt;?</span><span class="pln">php echo $view</span><span class="pun">[</span><span class="str">&#39;router&#39;</span><span class="pun">]-&gt;</span><span class="pln">generate</span><span class="pun">(</span></code></li><li class="L0"><code class="language-php"><span class="pln"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="str">&#39;blog_show&#39;</span><span class="pun">,</span></code></li><li class="L1"><code class="language-php"><span class="pln"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;array</span><span class="pun">(</span><span class="str">&#39;id&#39;</span><span class="pln"> </span><span class="pun">=&gt;</span><span class="pln"> $post</span><span class="pun">-&gt;</span><span class="pln">getId</span><span class="pun">())</span></code></li><li class="L2"><code class="language-php"><span class="pln"> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="pun">)</span><span class="pln"> </span><span class="pun">?&gt;</span><span class="pln">&quot;&gt;</span></code></li><li class="L3"><code class="language-php"><span class="pln"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="pun">&lt;?</span><span class="pln">php echo $post</span><span class="pun">-&gt;</span><span class="pln">getTitle</span><span class="pun">()</span><span class="pln"> </span><span class="pun">?&gt;</span></code></li><li class="L4"><code class="language-php"><span class="pln"> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="tag">&lt;/a&gt;</span></code></li><li class="L5"><code class="language-php"><span class="pln"> &nbsp; &nbsp;</span><span class="tag">&lt;/li&gt;</span></code></li><li class="L6"><code class="language-php"><span class="pln"> &nbsp; &nbsp;</span><span class="pun">&lt;?</span><span class="pln">php endforeach </span><span class="pun">?&gt;</span></code></li><li class="L7"><code class="language-php"><span class="tag">&lt;/ul&gt;</span></code></li></ol></pre><p>布局模板几乎是相同的:</p><pre class="prettyprint linenums prettyprinted" style=""><ol class="linenums list-paddingleft-2"><li class="L0"><code class="language-php"><span class="com">&lt;!-- app/Resources/views/layout.html.php --&gt;</span></code></li><li class="L1"><code class="language-php"><span class="dec">&lt;!DOCTYPE html&gt;</span></code></li><li class="L2"><code class="language-php"><span class="tag">&lt;html&gt;</span></code></li><li class="L3"><code class="language-php"><span class="pln"> &nbsp; &nbsp;</span><span class="tag">&lt;head&gt;</span></code></li><li class="L4"><code class="language-php"><span class="pln"> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="tag">&lt;title&gt;</span><span class="pun">&lt;?</span><span class="pln">php echo $view</span><span class="pun">[</span><span class="str">&#39;slots&#39;</span><span class="pun">]-&gt;</span><span class="pln">output</span><span class="pun">(</span></code></li><li class="L5"><code class="language-php"><span class="pln"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="str">&#39;title&#39;</span><span class="pun">,</span></code></li><li class="L6"><code class="language-php"><span class="pln"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="str">&#39;Default title&#39;</span></code></li><li class="L7"><code class="language-php"><span class="pln"> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="pun">)</span><span class="pln"> </span><span class="pun">?&gt;</span><span class="tag">&lt;/title&gt;</span></code></li><li class="L8"><code class="language-php"><span class="pln"> &nbsp; &nbsp;</span><span class="tag">&lt;/head&gt;</span></code></li><li class="L9"><code class="language-php"><span class="pln"> &nbsp; &nbsp;</span><span class="tag">&lt;body&gt;</span></code></li><li class="L0"><code class="language-php"><span class="pln"> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="pun">&lt;?</span><span class="pln">php echo $view</span><span class="pun">[</span><span class="str">&#39;slots&#39;</span><span class="pun">]-&gt;</span><span class="pln">output</span><span class="pun">(</span><span class="str">&#39;_content&#39;</span><span class="pun">)</span><span class="pln"> </span><span class="pun">?&gt;</span></code></li><li class="L1"><code class="language-php"><span class="pln"> &nbsp; &nbsp;</span><span class="tag">&lt;/body&gt;</span></code></li><li class="L2"><code class="language-php"><span class="tag">&lt;/html&gt;</span></code></li></ol></pre><p>&nbsp;&nbsp;&nbsp;&nbsp;该展示模板用作练习.这是相当简单的,基本上微不足道.</p><p>&nbsp;&nbsp;&nbsp;&nbsp;当 Symfony称之为<code class="docutils literal"><span style="color: rgb(255, 0, 0);">Kernel</span></code>的引擎启动时,他需要知道控制器和请求的一个映射关系.一个提前约定好的可读的路由配置需要被提供:</p><pre class="prettyprint linenums prettyprinted" style=""><ol class="linenums list-paddingleft-2"><li class="L0"><code class="language-php"><span class="com"># app/config/routing.yml</span></code></li><li class="L1"><code class="language-php"><span class="pln">blog_list</span><span class="pun">:</span></code></li><li class="L2"><code class="language-php"><span class="pln"> &nbsp; &nbsp;path</span><span class="pun">:</span><span class="pln"> &nbsp; &nbsp; </span><span class="pun">/</span><span class="pln">blog</span></code></li><li class="L3"><code class="language-php"><span class="pln"> &nbsp; &nbsp;defaults</span><span class="pun">:</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> _controller</span><span class="pun">:</span><span class="pln"> </span><span class="typ">AppBundle</span><span class="pun">:</span><span class="typ">Blog</span><span class="pun">:</span><span class="pln">list </span><span class="pun">}</span></code></li><li class="L4"><code class="language-php"></code></li><li class="L5"><code class="language-php"><span class="pln">blog_show</span><span class="pun">:</span></code></li><li class="L6"><code class="language-php"><span class="pln"> &nbsp; &nbsp;path</span><span class="pun">:</span><span class="pln"> &nbsp; &nbsp; </span><span class="str">/blog/</span><span class="pln">show</span><span class="pun">/{</span><span class="pln">id</span><span class="pun">}</span></code></li><li class="L7"><code class="language-php"><span class="pln"> &nbsp; &nbsp;defaults</span><span class="pun">:</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> _controller</span><span class="pun">:</span><span class="pln"> </span><span class="typ">AppBundle</span><span class="pun">:</span><span class="typ">Blog</span><span class="pun">:</span><span class="pln">show </span><span class="pun">}</span></code></li></ol></pre><p>&nbsp;&nbsp;&nbsp;&nbsp;现在.Symfony已经可以处理一些日常任务了.前段控制器真的时特别简单,当他被创建后,你就再也不用去管他了(<span style="line-height: 1.6;">如果你使用Symfony的分布，你甚至不会需要创建它</span><span style="line-height: 1.6;">).</span></p><p><span style="line-height: 1.6;"></span></p><pre class="prettyprint linenums prettyprinted" style=""><ol class="linenums list-paddingleft-2"><li class="L0"><code class="language-php"><span class="com">// web/app.php</span></code></li><li class="L1"><code class="language-php"><span class="pln">require_once __DIR__</span><span class="pun">.</span><span class="str">&#39;/../app/bootstrap.php&#39;</span><span class="pun">;</span></code></li><li class="L2"><code class="language-php"><span class="pln">require_once __DIR__</span><span class="pun">.</span><span class="str">&#39;/../app/AppKernel.php&#39;</span><span class="pun">;</span></code></li><li class="L3"><code class="language-php"></code></li><li class="L4"><code class="language-php"><span class="kwd">use</span><span class="pln"> </span><span class="typ">Symfony</span><span class="pln">\Component\HttpFoundation\Request</span><span class="pun">;</span></code></li><li class="L5"><code class="language-php"></code></li><li class="L6"><code class="language-php"><span class="pln">$kernel </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">AppKernel</span><span class="pun">(</span><span class="str">&#39;prod&#39;</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">false</span><span class="pun">);</span></code></li><li class="L7"><code class="language-php"><span class="pln">$kernel</span><span class="pun">-&gt;</span><span class="pln">handle</span><span class="pun">(</span><span class="typ">Request</span><span class="pun">::</span><span class="pln">createFromGlobals</span><span class="pun">())-&gt;</span><span class="pln">send</span><span class="pun">();</span></code></li></ol></pre><br/><p>&nbsp;&nbsp;&nbsp;&nbsp;前段控制器的唯一工作就是去初始化Symfony的模板引擎(<code class="docutils literal"><span style="color: rgb(255, 0, 0);">Kernel</span></code>),并且传递一个请求(<code class="docutils literal"><span style="color: rgb(255, 0, 0);">Request</span></code>)交由内核处理.Symfony通过使用路由映射来决定调用哪一个控制器.就象以前一样,作为响应,控制器方法是用来返回<code class="docutils literal"><span style="color: rgb(255, 0, 0);">Response</span></code>对象的.</p><p><span style="line-height: 1.6;"></span></p><h3><br/></h3><h3>Symfony的优点</h3><p>&nbsp;&nbsp;&nbsp;&nbsp;在即将到来的章节中,你将会了解更多关于Sfmfony的工作机制以推荐的项目组织.现在,看看如何从原生的php迁移使用symfony来提升blog的质量:</p><ul style="list-style-type: disc;" class=" list-paddingleft-2"><li><p><span style="line-height: 1.6;">你的应用程序现在已经明确了一贯有组织的代码（虽然Symfony的不强迫你使用）。这促进了可重用性，并允许新的开发人员在你的项目更快速地成为生产力;</span></p></li><li><p><span style="line-height: 1.6;">你写的代码1000%都是你的应用程序,你不许要去建立或维护低级别的实用程序,例如:自动载入,路由,以及模板渲染控制</span></p></li><li><p><span style="line-height: 1.6;"></span>在Symfony中，你可以访问开源工具，如<code class="docutils literal"><span style="color: rgb(255, 0, 0);">Doctrine</span></code>和<code class="docutils literal"><span style="color: rgb(255, 0, 0);">Templating</span></code>，安全(<code class="docutils literal"><span style="color: rgb(255, 0, 0);">Security</span></code>)，表单(<code class="docutils literal"><span style="color: rgb(255, 0, 0);">Form</span></code>)，验证(<code class="docutils literal"><span style="color: rgb(255, 0, 0);">Validation</span></code>)和翻译(<code class="docutils literal"><span style="color: rgb(255, 0, 0);">Translation</span></code>)等组件（仅举几例）;</p></li><li><p>应用有着完全灵活的url,感谢路由组件</p></li><li><p id="result" style="margin-top: 0px; margin-bottom: 0px; white-space: normal;">&nbsp;Symfony以HTTP为核心的架构，让你可以访问功能强大的工具，如HTTP缓存搭载的Symfony的内部HTTP缓存或更强大的工具，如<a class="reference external" href="https://www.varnish-cache.org/"><code class="docutils literal"><span style="color: rgb(255, 0, 0);">Varnish</span></code></a>。关于缓存这将会在后面的章节提到。 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</p></li></ul><p><span style="line-height: 1.6;">&nbsp;&nbsp;&nbsp;&nbsp;最重要的是，通过使用Symfony的，你有机会获得一整套高质量的由Symfony的社区开发的开源工具！Symfony的社区工具可以在</span><a class="reference external" href="http://knpbundles.com/"><code class="docutils literal"><span style="color: rgb(255, 0, 0);">KnpBundles.com</span></code></a><span style="line-height: 1.6;">找到。 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><br/></p><p>
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</p><h2>更好用的模板引擎</h2><p>&nbsp;&nbsp;&nbsp;&nbsp;如果你选择去使用它,Symfony有一个标配的的名为Twig的模板引擎,,它可以让模板更快地编写,更加易于阅读.&nbsp; &nbsp; 这意味着示例应用程序可以包含更少的代码.例如,展示模板可以用Twig这样写:</p><p>&nbsp;&nbsp; &nbsp; &nbsp;</p><pre class="prettyprint linenums prettyprinted" style=""><ol class="linenums list-paddingleft-2"><li class="L0"><code class="language-php"><span class="pun">{#</span><span class="pln"> app</span><span class="pun">/</span><span class="typ">Resources</span><span class="pun">/</span><span class="pln">views</span><span class="pun">/</span><span class="pln">blog</span><span class="pun">/</span><span class="pln">list</span><span class="pun">.</span><span class="pln">html</span><span class="pun">.</span><span class="pln">twig </span><span class="com">#}</span></code></li><li class="L1"><code class="language-php"><span class="pun">{%</span><span class="pln"> </span><span class="kwd">extends</span><span class="pln"> </span><span class="str">&quot;layout.html.twig&quot;</span><span class="pln"> </span><span class="pun">%}</span></code></li><li class="L2"><code class="language-php"></code></li><li class="L3"><code class="language-php"><span class="pun">{%</span><span class="pln"> block title </span><span class="pun">%}</span><span class="typ">List</span><span class="pln"> of </span><span class="typ">Posts</span><span class="pun">{%</span><span class="pln"> endblock </span><span class="pun">%}</span></code></li><li class="L4"><code class="language-php"></code></li><li class="L5"><code class="language-php"><span class="pun">{%</span><span class="pln"> block body </span><span class="pun">%}</span></code></li><li class="L6"><code class="language-php"><span class="pln"> &nbsp; &nbsp;</span><span class="str">&lt;h1&gt;</span><span class="typ">List</span><span class="pln"> of </span><span class="typ">Posts</span><span class="pun">&lt;/</span><span class="pln">h1</span><span class="pun">&gt;</span></code></li><li class="L7"><code class="language-php"><span class="pln"> &nbsp; &nbsp;</span><span class="str">&lt;ul&gt;</span></code></li><li class="L8"><code class="language-php"><span class="pln"> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="pun">{%</span><span class="pln"> </span><span class="kwd">for</span><span class="pln"> post </span><span class="kwd">in</span><span class="pln"> posts </span><span class="pun">%}</span></code></li><li class="L9"><code class="language-php"><span class="pln"> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="str">&lt;li&gt;</span></code></li><li class="L0"><code class="language-php"><span class="pln"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="pun">&lt;</span><span class="pln">a href</span><span class="pun">=</span><span class="str">&quot;{{ path(&#39;blog_show&#39;, {&#39;id&#39;: post.id}) }}&quot;</span><span class="pun">&gt;</span></code></li><li class="L1"><code class="language-php"><span class="pln"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="pun">{{</span><span class="pln"> post</span><span class="pun">.</span><span class="pln">title </span><span class="pun">}}</span></code></li><li class="L2"><code class="language-php"><span class="pln"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="pun">&lt;/</span><span class="pln">a</span><span class="pun">&gt;</span></code></li><li class="L3"><code class="language-php"><span class="pln"> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="pun">&lt;/</span><span class="pln">li</span><span class="pun">&gt;</span></code></li><li class="L4"><code class="language-php"><span class="pln"> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="pun">{%</span><span class="pln"> endfor </span><span class="pun">%}</span></code></li><li class="L5"><code class="language-php"><span class="pln"> &nbsp; &nbsp;</span><span class="pun">&lt;/</span><span class="pln">ul</span><span class="pun">&gt;</span></code></li><li class="L6"><code class="language-php"><span class="pun">{%</span><span class="pln"> endblock </span><span class="pun">%}</span></code></li></ol></pre><p>&nbsp;&nbsp;&nbsp;&nbsp;相应的,<code class="docutils literal"><span class="pre">layout.html.twig</span></code>也是非常容易写出的:</p><div><pre class="prettyprint linenums prettyprinted" style=""><ol class="linenums list-paddingleft-2"><li class="L0"><code class="language-php"><span class="pun">{#</span><span class="pln"> app</span><span class="pun">/</span><span class="typ">Resources</span><span class="pun">/</span><span class="pln">views</span><span class="pun">/</span><span class="pln">layout</span><span class="pun">.</span><span class="pln">html</span><span class="pun">.</span><span class="pln">twig </span><span class="com">#}</span></code></li><li class="L1"><code class="language-php"><span class="pun">&lt;!</span><span class="pln">DOCTYPE html</span><span class="pun">&gt;</span></code></li><li class="L2"><code class="language-php"><span class="str">&lt;html&gt;</span></code></li><li class="L3"><code class="language-php"><span class="pln"> &nbsp; &nbsp;</span><span class="str">&lt;head&gt;</span></code></li><li class="L4"><code class="language-php"><span class="pln"> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="str">&lt;title&gt;</span><span class="pun">{%</span><span class="pln"> block title </span><span class="pun">%}</span><span class="typ">Default</span><span class="pln"> title</span><span class="pun">{%</span><span class="pln"> endblock </span><span class="pun">%}&lt;/</span><span class="pln">title</span><span class="pun">&gt;</span></code></li><li class="L5"><code class="language-php"><span class="pln"> &nbsp; &nbsp;</span><span class="pun">&lt;/</span><span class="pln">head</span><span class="pun">&gt;</span></code></li><li class="L6"><code class="language-php"><span class="pln"> &nbsp; &nbsp;</span><span class="str">&lt;body&gt;</span></code></li><li class="L7"><code class="language-php"><span class="pln"> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="pun">{%</span><span class="pln"> block body </span><span class="pun">%}{%</span><span class="pln"> endblock </span><span class="pun">%}</span></code></li><li class="L8"><code class="language-php"><span class="pln"> &nbsp; &nbsp;</span><span class="pun">&lt;/</span><span class="pln">body</span><span class="pun">&gt;</span></code></li><li class="L9"><code class="language-php"><span class="pun">&lt;/</span><span class="pln">html</span><span class="pun">&gt;</span></code></li></ol></pre></div><br/><p><br/></p><p>
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</p><p id="result" style="margin-top: 0px; margin-bottom: 0px;"><span style="line-height: 1.6;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><br/></p><h2 style="font-family: Helvetica, &#39;Hiragino Sans GB&#39;, &#39;Microsoft Yahei&#39;, SimSun, SimHei, arial, sans-serif; white-space: normal;"><span style="line-height: 1.6;">我的主页:<a href="http://aifei8.net/">http://aifei8.net</a>:</span></h2><p style="white-space: normal;"><span style="line-height: 1.6;"></span></p><p style="white-space: normal;"><img border="0" _src="file:///tmp/user/0/WizNote/e4e88c9a-b500-4e30-a0a7-493971b61d0d/第6章.Symfony 快速入门-Symfony vs 原生PHP_files/2bc4b8e6-ed92-4174-83ef-511e72b978d4.png" src="第6章.Symfony 快速入门-Symfony vs 原生PHP_files/2bc4b8e6-ed92-4174-83ef-511e72b978d4.png" /></p><p style="white-space: normal;"><img border="0" _src="file:///tmp/user/0/WizNote/e4e88c9a-b500-4e30-a0a7-493971b61d0d/第6章.Symfony 快速入门-Symfony vs 原生PHP_files/89f21de2-8ae9-4609-ace7-2be6e53a2d4f.png" src="第6章.Symfony 快速入门-Symfony vs 原生PHP_files/89f21de2-8ae9-4609-ace7-2be6e53a2d4f.png" /></p><p style="white-space: normal;"><span style="line-height: 1.6;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</span><br/></p><h2 style="margin-top: 0px; margin-bottom: 0px; font-family: Helvetica, &#39;Hiragino Sans GB&#39;, &#39;Microsoft Yahei&#39;, SimSun, SimHei, arial, sans-serif; white-space: normal;">我的博客:<a href="http://blog.aifei8.net/">http://blog.aifei8.net</a>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br/></h2><h2 style="font-family: Helvetica, &#39;Hiragino Sans GB&#39;, &#39;Microsoft Yahei&#39;, SimSun, SimHei, arial, sans-serif; white-space: normal;">github主页:<a href="http://github.com/Pengfei-Gao">http://github.com/Pengfei-Gao</a>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</h2><p style="white-space: normal;">&nbsp;</p><p style="white-space: normal;"><img border="0" _src="file:///tmp/user/0/WizNote/e4e88c9a-b500-4e30-a0a7-493971b61d0d/第6章.Symfony 快速入门-Symfony vs 原生PHP_files/c8a0602d-a0a6-4862-bd6a-684e22595b7d.png" src="第6章.Symfony 快速入门-Symfony vs 原生PHP_files/c8a0602d-a0a6-4862-bd6a-684e22595b7d.png" /></p><p style="white-space: normal;"><img border="0" width="109" height="44" _src="file:///tmp/user/0/WizNote/e4e88c9a-b500-4e30-a0a7-493971b61d0d/第6章.Symfony 快速入门-Symfony vs 原生PHP_files/c1351b29-d6fc-4d5b-a55a-3e33dfca5515.gif" style="height: 44px; line-height: 1.6; font-weight: bold; width: 109px;" src="第6章.Symfony 快速入门-Symfony vs 原生PHP_files/c1351b29-d6fc-4d5b-a55a-3e33dfca5515.gif" />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br/></p><p style="white-space: normal;"><span style="line-height: 1.6;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span style="line-height: 1.6;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><br/></p><p style="white-space: normal;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br/></p><p style="white-space: normal;"><span style="line-height: 1.6;"></span><br/></p><p style="white-space: normal;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</p><p id="result" style="margin-top: 0px; margin-bottom: 0px;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;<br/></p><p>
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</p><p>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br/></p><p><span style="line-height: 1.6;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><br/></p><p>
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</p><p id="result" style="margin-top: 0px; margin-bottom: 0px;"><br/></p><p>
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</p><p>,<br/></p>
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<p>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</p><p>
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</p><p><br/></p><p><br/></p></body></html>