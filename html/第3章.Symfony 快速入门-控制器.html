<!DOCTYPE html><html><head><style type="text/css" id="wiz_custom_css"> html, body { font-size: 15px; } body { font-family: Helvetica, "Hiragino Sans GB", "Microsoft Yahei", SimSun, SimHei, arial, sans-serif; line-height: 1.6; padding: 0; margin: 20px 36px; margin: 1.33rem 2.4rem; } h1, h2, h3, h4, h5, h6 { margin: 20px 0 10px; margin: 1.33rem 0 0.667rem; padding: 0; font-weight: bold; } h1 { font-size: 21px; font-size: 1.4rem; } h2 { font-size: 20px; font-size: 1.33rem; } h3 { font-size: 18px; font-size: 1.2rem; } h4 { font-size: 17px; font-size: 1.13rem; } h5 { font-size: 15px; font-size: 1rem; } h6 { font-size: 15px; font-size: 1rem; color: #777777; margin: 1rem 0; } div, p, blockquote, ul, ol, dl, table, pre { margin: 10px 0; margin: 0.667rem 0; } ul, ol { padding-left: 32px; padding-left: 2.13rem; } blockquote { border-left: 4px solid #dddddd; padding: 0 12px; padding: 0 0.8rem; color: #aaa; } blockquote > :first-child { margin-top: 0; } blockquote > :last-child { margin-bottom: 0; } img { border: 0; max-width: 100%; height: auto !important; } table { border-collapse: collapse; border: 1px solid #bbbbbb; } td { border-collapse: collapse; border: 1px solid #bbbbbb; } @media screen and (max-width: 660px) { body { margin: 20px 18px; margin: 1.33rem 1.2rem; } } @media only screen and (-webkit-max-device-width: 1024px), only screen and (-o-max-device-width: 1024px), only screen and (max-device-width: 1024px), only screen and (-webkit-min-device-pixel-ratio: 3), only screen and (-o-min-device-pixel-ratio: 3), only screen and (min-device-pixel-ratio: 3) { html, body { font-size: 17px; } body { line-height: 1.7; margin: 12px 15px; margin: 0.75rem 0.9375rem; color: #353c47; } h1 { font-size: 34px; font-size: 2.125rem; } h2 { font-size: 30px; font-size: 1.875rem; } h3 { font-size: 26px; font-size: 1.625rem; } h4 { font-size: 22px; font-size: 1.375rem; } h5 { font-size: 18px; font-size: 1.125rem; } h6 { color: inherit; } div, p, blockquote, ul, ol, dl, table, pre { margin: 0; } ul, ol { padding-left: 40px; padding-left: 2.5rem; } blockquote { border-left: 4px solid #c8d4e8; padding: 0 15px; padding: 0 0.9375rem; color: #b3c2dd; } } </style><style type="text/css" id="wiz_todo_style_id" wiz_link_version="01.00.09">.wiz-todo, .wiz-todo-img {width: 16px; height: 16px; cursor: default; padding: 0 10px 0 2px; vertical-align: -10%;-webkit-user-select: none;} .wiz-todo-label { display: inline-block; padding-top: 7px; padding-bottom: 6px; line-height: 1.5;} .wiz-todo-label-checked { /*text-decoration: line-through;*/ color: #666;} .wiz-todo-label-unchecked {text-decoration: initial;} .wiz-todo-completed-info {padding-left: 44px; display: inline-block; } .wiz-todo-avatar { width:20px; height: 20px; vertical-align: -20%; margin-right:10px; border-radius: 2px;} .wiz-todo-account, .wiz-todo-dt { color: #666; }</style><link type="text/css" rel="stylesheet" id="wiz_code_highlight_link" href="第3章.Symfony 快速入门-控制器_files/wiz_code_highlight.css"></head><body><p><img border="0" width="106" height="42" _src="file:///tmp/WizNote/b024b896-e570-4fe8-9057-17effdc58b5f/第3章.Symfony 快速入门-控制器_files/e7a5fb96-9d85-4388-834d-87a9989c5ae8.gif" style="height: 42px; white-space: normal; width: 106px;" src="第3章.Symfony 快速入门-控制器_files/e7a5fb96-9d85-4388-834d-87a9989c5ae8.gif" /><span style="white-space: normal;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><img border="0" width="147" height="59" _src="file:///tmp/WizNote/31818df4-6479-4bbd-8b12-8d54db9f7066.gif" style="height: 59px; line-height: 1.6; white-space: normal; width: 147px;" src="第3章.Symfony 快速入门-控制器_files/31818df4-6479-4bbd-8b12-8d54db9f7066.gif" /><span style="white-space: normal;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><img border="0" width="109" height="44" _src="file:///tmp/user/0/WizNote/e4e88c9a-b500-4e30-a0a7-493971b61d0d/file:///tmp/user/0/WizNote/5b35d89f-24bf-488d-9f50-41480c8b6acc/第3章.Symfony 快速入门-控制器_files/c1351b29-d6fc-4d5b-a55a-3e33dfca5515.gif" style="height: 44px; line-height: 1.6; white-space: normal; font-weight: bold; width: 109px;" src="第3章.Symfony 快速入门-控制器_files/c1351b29-d6fc-4d5b-a55a-3e33dfca5515.gif" /><span style="white-space: normal;"></span></p><p>&nbsp;&nbsp;&nbsp;&nbsp;在学习完前面两章的内容之后,我相信你绝对已经迷上了Symfony,成为了他的忠实粉丝,无需再费周折,接下来我将带着你去了解Symfony的控制器(<span style="line-height: 1.6;"><code class="docutils literal"><span style="line-height: 1.6; color: rgb(255, 0, 0);">controllers</span></code></span>),现在,我忠实的读者,看看它到底能为你做些什莫呢?.</p><p><br/></p><h2>返回原生的响应(<span style="font-size: 1.33rem; line-height: 1.6;">Returning Raw Responses</span><span style="font-size: 1.33rem; line-height: 1.6;">)</span></h2><p><span style="font-size: 1.33rem; line-height: 1.6;"></span></p><p><span style="line-height: 1.6;">&nbsp;&nbsp;&nbsp;&nbsp;Symfony的将自
己定义为一个请求 - 
响应(</span><span style="line-height: 1.6;"><code class="docutils literal"><span style="line-height: 1.6; color: rgb(255, 0, 0);">Request-Response</span></code></span><span style="line-height: 1.6;">)框架。当用户发出请求(</span><span style="line-height: 1.6;"><code class="docutils literal"><span style="line-height: 1.6; color: rgb(255, 0, 0);">request</span></code></span><span style="line-height: 1.6;">)到应用程序时，Symfony的创建一个<code class="docutils literal"><span style="line-height: 1.6; color: rgb(255, 0, 0);">Request</span></code>对象来封装所有相关的必不可少的信息。同样，执行任何控制器(</span><span style="line-height: 1.6;"><code class="docutils literal"><span style="line-height: 1.6; color: rgb(255, 0, 0);">controller</span></code></span><span style="line-height: 1.6;">)的任何动作(</span><span style="line-height: 1.6;"><code class="docutils literal"><span style="line-height: 1.6; color: rgb(255, 0, 0);">action</span></code></span><span style="line-height: 1.6;">)的结果
是创建了一个</span><span style="line-height: 1.6;"><code class="docutils literal"><span style="line-height: 1.6; color: rgb(255, 0, 0);">Response</span></code></span><span style="line-height: 1.6;">的对象,这个对象是Symfony生成用来返回给用户的HTML内容。</span><span style="line-height: 1.6;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</span></p><p id="result" style="margin-top: 0px; margin-bottom: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;到目前为止，本教程中的操作一般使用<span style="line-height: 1.6;"><code class="docutils literal"><span style="line-height: 1.6; color: rgb(255, 0, 0);">$this-&gt;render()</span></code></span><code class="docutils literal">方法</code>返回的渲染响应作为结果。如果你需要它，你也可以创建一个原始<span style="line-height: 1.6;"><code class="docutils literal"><span style="line-height: 1.6; color: rgb(255, 0, 0);">Response</span></code></span>对象返回任何文本内容：</p><p>
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</p><pre class="prettyprint linenums prettyprinted" style=""><ol class="linenums list-paddingleft-2"><li class="L0"><code class="language-php"><span class="com">// src/AppBundle/Controller/DefaultController.php</span></code></li><li class="L1"><code class="language-php"><span class="kwd">namespace</span><span class="pln"> </span><span class="typ">AppBundle</span><span class="pln">\Controller</span><span class="pun">;</span></code></li><li class="L2"><code class="language-php"></code></li><li class="L3"><code class="language-php"><span class="kwd">use</span><span class="pln"> </span><span class="typ">Sensio</span><span class="pln">\Bundle\FrameworkExtraBundle\Configuration\Route</span><span class="pun">;</span></code></li><li class="L4"><code class="language-php"><span class="kwd">use</span><span class="pln"> </span><span class="typ">Symfony</span><span class="pln">\Bundle\FrameworkBundle\Controller\Controller</span><span class="pun">;</span></code></li><li class="L5"><code class="language-php"><span class="kwd">use</span><span class="pln"> </span><span class="typ">Symfony</span><span class="pln">\Component\HttpFoundation\Response</span><span class="pun">;</span></code></li><li class="L6"><code class="language-php"></code></li><li class="L7"><code class="language-php"><span class="kwd">class</span><span class="pln"> </span><span class="typ">DefaultController</span><span class="pln"> </span><span class="kwd">extends</span><span class="pln"> </span><span class="typ">Controller</span></code></li><li class="L8"><code class="language-php"><span class="pun">{</span></code></li><li class="L9"><code class="language-php"><span class="pln"> &nbsp; &nbsp;</span><span class="com">/**</span></code></li><li class="L0"><code class="language-php"><span class="com"> &nbsp; &nbsp; * @Route(&quot;/&quot;, name=&quot;homepage&quot;)</span></code></li><li class="L1"><code class="language-php"><span class="com"> &nbsp; &nbsp; */</span></code></li><li class="L2"><code class="language-php"><span class="pln"> &nbsp; &nbsp;</span><span class="kwd">public</span><span class="pln"> </span><span class="kwd">function</span><span class="pln"> indexAction</span><span class="pun">()</span></code></li><li class="L3"><code class="language-php"><span class="pln"> &nbsp; &nbsp;</span><span class="pun">{</span></code></li><li class="L4"><code class="language-php"><span class="pln"> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="kwd">return</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">Response</span><span class="pun">(</span><span class="str">&#39;Welcome to Symfony!&#39;</span><span class="pun">);</span></code></li><li class="L5"><code class="language-php"><span class="pln"> &nbsp; &nbsp;</span><span class="pun">}</span></code></li><li class="L6"><code class="language-php"><span class="pun">}</span></code></li></ol></pre><h2><br/></h2><h2>路由参数(<span style="font-size: 1.33rem; font-weight: bold; font-family: Helvetica, &#39;Hiragino Sans GB&#39;, &#39;Microsoft Yahei&#39;, SimSun, SimHei, arial, sans-serif; line-height: 1.6;">Route Parameters</span><span style="line-height: 1.6;">)</span></h2><p><span style="line-height: 1.6;"></span></p><p><span style="line-height: 1.6;">&nbsp;&nbsp;&nbsp;&nbsp;在大多数情况下，应用程序的URL包括在他们变量部件(</span><span style="line-height: 1.6;"><code class="docutils literal"><span style="line-height: 1.6; color: rgb(255, 0, 0);">variable parts</span></code></span><span style="line-height: 1.6;">)。如果您正在创建类似于博客那样的应用程序，博客上显示的文章应当包括文章标题以及其他唯一标识符的URL，让应用程序确切的知道要显示那一篇文章。</span><br/></p><p><span style="line-height: 1.6;">&nbsp;&nbsp;&nbsp;&nbsp;在Symfony的应用程序中，路由的变量部件(</span><span style="line-height: 1.6;"><code class="docutils literal"><span style="line-height: 1.6; color: rgb(255, 0, 0);">variable parts</span></code></span><span style="line-height: 1.6;">)被包含在大括号中（</span><span style="line-height: 1.6;"><code class="docutils literal"><span style="line-height: 1.6; color: rgb(255, 0, 0);">/blog/read/{article_title}/</span></code></span><span style="line-height: 1.6;">）。每个变量的部分被赋予一个唯一的名字以便以后用于在控制器检索每一个变量的值.</span></p><p><span style="line-height: 1.6;"></span></p><p id="result" style="margin-top: 0px; margin-bottom: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;接下来我们将为<span style="line-height: 27px;">路由变量(</span><span style="line-height: 1.6;"><code class="docutils literal"><span style="line-height: 1.6; color: rgb(255, 0, 0);">route variables</span></code></span><span style="line-height: 27px;">)</span>创建一个新的动作(<span style="line-height: 1.6;"><code class="docutils literal"><span style="line-height: 1.6; color: rgb(255, 0, 0);">action)</span></code></span>，用来操作路由参数,打开<span style="line-height: 1.6;"><code class="docutils literal"><span style="line-height: 1.6; color: rgb(255, 0, 0);">src/AppBundle/Controller/DefaultController.php</span></code></span>&nbsp; &nbsp;文件,并且添加一个名为<span style="line-height: 1.6;"><code class="docutils literal"><span style="line-height: 1.6; color: rgb(255, 0, 0);">helloAction</span></code></span>的方法,如下所示:</p><pre class="prettyprint linenums prettyprinted" style=""><ol class="linenums list-paddingleft-2"><li class="L0"><code class="language-php"><span class="com">// src/AppBundle/Controller/DefaultController.php</span></code></li><li class="L1"><code class="language-php"><span class="kwd">namespace</span><span class="pln"> </span><span class="typ">AppBundle</span><span class="pln">\Controller</span><span class="pun">;</span></code></li><li class="L2"><code class="language-php"></code></li><li class="L3"><code class="language-php"><span class="kwd">use</span><span class="pln"> </span><span class="typ">Sensio</span><span class="pln">\Bundle\FrameworkExtraBundle\Configuration\Route</span><span class="pun">;</span></code></li><li class="L4"><code class="language-php"><span class="kwd">use</span><span class="pln"> </span><span class="typ">Symfony</span><span class="pln">\Bundle\FrameworkBundle\Controller\Controller</span><span class="pun">;</span></code></li><li class="L5"><code class="language-php"></code></li><li class="L6"><code class="language-php"><span class="kwd">class</span><span class="pln"> </span><span class="typ">DefaultController</span><span class="pln"> </span><span class="kwd">extends</span><span class="pln"> </span><span class="typ">Controller</span></code></li><li class="L7"><code class="language-php"><span class="pun">{</span></code></li><li class="L8"><code class="language-php"><span class="pln"> &nbsp; &nbsp;</span><span class="com">// ...</span></code></li><li class="L9"><code class="language-php"></code></li><li class="L0"><code class="language-php"><span class="pln"> &nbsp; &nbsp;</span><span class="com">/**</span></code></li><li class="L1"><code class="language-php"><span class="com"> &nbsp; &nbsp; * @Route(&quot;/hello/{name}&quot;, name=&quot;hello&quot;)</span></code></li><li class="L2"><code class="language-php"><span class="com"> &nbsp; &nbsp; */</span></code></li><li class="L3"><code class="language-php"><span class="pln"> &nbsp; &nbsp;</span><span class="kwd">public</span><span class="pln"> </span><span class="kwd">function</span><span class="pln"> helloAction</span><span class="pun">(</span><span class="pln">$name</span><span class="pun">)</span></code></li><li class="L4"><code class="language-php"><span class="pln"> &nbsp; &nbsp;</span><span class="pun">{</span></code></li><li class="L5"><code class="language-php"><span class="pln"> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="kwd">return</span><span class="pln"> $this</span><span class="pun">-&gt;</span><span class="pln">render</span><span class="pun">(</span><span class="str">&#39;default/hello.html.twig&#39;</span><span class="pun">,</span><span class="pln"> array</span><span class="pun">(</span></code></li><li class="L6"><code class="language-php"><span class="pln"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="str">&#39;name&#39;</span><span class="pln"> </span><span class="pun">=&gt;</span><span class="pln"> $name</span></code></li><li class="L7"><code class="language-php"><span class="pln"> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="pun">));</span></code></li><li class="L8"><code class="language-php"><span class="pln"> &nbsp; &nbsp;</span><span class="pun">}</span></code></li><li class="L9"><code class="language-php"><span class="pun">}</span></code><span style="line-height: 1.6; font-family: Arial; font-size: 15px;">&nbsp;</span></li></ol></pre><p><span style="line-height: 1.6;"></span>打开你的浏览器并且访问<span style="line-height: 1.6;"><code class="docutils literal"><span style="line-height: 1.6; color: rgb(255, 0, 0);">http://localhost:8000/hello/fabien</span></code></span>,就可以看到执行这个新的动作(<span style="line-height: 1.6;"><code class="docutils literal"><span style="line-height: 1.6; color: rgb(255, 0, 0);">action</span></code></span>)的结果了.如果人品太差,你会看到一个错误页面.或许你可能已经猜到,导致这个错误的原因是因为你尝试渲染一个不存在的模板(<span style="line-height: 1.6;"><code class="docutils literal"><span style="line-height: 1.6; color: rgb(255, 0, 0);">default/hello.html.twig)</span></code></span>,创建一个新的模板并且添加如下内容:</p><pre class="prettyprint linenums prettyprinted" style=""><ol class="linenums list-paddingleft-2"><li class="L0"><code class="language-php"><span class="pun">{#</span><span class="pln"> app</span><span class="pun">/</span><span class="typ">Resources</span><span class="pun">/</span><span class="pln">views</span><span class="pun">/</span><span class="kwd">default</span><span class="pun">/</span><span class="pln">hello</span><span class="pun">.</span><span class="pln">html</span><span class="pun">.</span><span class="pln">twig </span><span class="com">#}</span></code></li><li class="L1"><code class="language-php"><span class="pun">{%</span><span class="pln"> </span><span class="kwd">extends</span><span class="pln"> </span><span class="str">&#39;base.html.twig&#39;</span><span class="pln"> </span><span class="pun">%}</span></code></li><li class="L2"><code class="language-php"></code></li><li class="L3"><code class="language-php"><span class="pun">{%</span><span class="pln"> block body </span><span class="pun">%}</span></code></li><li class="L4"><code class="language-php"><span class="pln"> &nbsp; &nbsp;</span><span class="str">&lt;h1&gt;</span><span class="typ">Hi</span><span class="pln"> </span><span class="pun">{{</span><span class="pln"> name </span><span class="pun">}}!</span><span class="pln"> </span><span class="typ">Welcome</span><span class="pln"> to </span><span class="typ">Symfony</span><span class="pun">!&lt;/</span><span class="pln">h1</span><span class="pun">&gt;</span></code></li><li class="L5"><code class="language-php"><span class="pun">{%</span><span class="pln"> endblock </span><span class="pun">%}</span></code></li></ol></pre><p>再次浏览<span style="line-height: 1.6;"><code class="docutils literal"><span style="line-height: 1.6; color: rgb(255, 0, 0);">http://localhost:8000/hello/fabien</span></code></span>页面,你将会看到你传入的路由参数已经被控制器渲染到这个模板上了.<span style="line-height: 27px;">如果你想要更改URL的最后一部分(e.g. </span><span style="line-height: 1.6;"><code class="docutils literal"><span style="line-height: 1.6; color: rgb(255, 0, 0);">http://localhost:8000/hello/thomas</span></code></span><span style="line-height: 27px;">)&nbsp; </span>并且重新加载网页内容,页面将会显示不同的信息.如果你去掉了URL的最后一部分内容(e.g. <span style="line-height: 1.6;"><code class="docutils literal"><span style="line-height: 1.6; color: rgb(255, 0, 0);">http://localhost:8000/hello</span></code></span>),<span style="line-height: 27px;">&nbsp;symfony将会显示一个错误的页面，因为该路由需要一个名字，但是你没有提供给它。</span></p><p><span style="line-height: 27px;">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</span></p>
 <h2>使用格式(<span style="font-size: 1.33rem; font-weight: bold; line-height: 1.6;">Using Formats</span>)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</h2><p><span style="line-height: 1.6;"></span></p><p><span style="line-height: 1.6;">&nbsp;&nbsp;&nbsp;&nbsp;如今，Web应用程序应该不仅仅只是提供HTML页面了。从XML的RSS源以及Web服务，到JSON的Ajax请求，也有很多不同的格式可供选择。Symfony支持这些格式的是直接得益于一个被称为</span><span style="line-height: 1.6;"><code class="docutils literal"><span style="line-height: 1.6; color: rgb(255, 0, 0);">_format</span></code></span><span style="line-height: 1.6;">的特殊变量,该变量用来存储用户请求的格式。</span><br/></p><p>&nbsp;&nbsp;&nbsp;&nbsp;调整<span style="line-height: 1.6;"><code class="docutils literal"><span style="line-height: 1.6; color: rgb(255, 0, 0);">hello&nbsp;</span></code></span>的路<span style="color: rgb(255, 0, 0); font-family: Consolas, &#39;Liberation Mono&#39;, Menlo, Courier, monospace; background-color: rgb(248, 248, 248);"></span>由,为html添加一个<span style="line-height: 1.6;"><code class="docutils literal"><span style="line-height: 1.6; color: rgb(255, 0, 0);">_format</span></code></span><code class="docutils literal"><span class="pre"> 变量</span></code>作为默认值:</p><pre class="prettyprint linenums prettyprinted" style=""><ol class="linenums list-paddingleft-2"><li class="L0"><code class="language-php"><span class="com">// src/AppBundle/Controller/DefaultController.php</span></code></li><li class="L1"><code class="language-php"><span class="kwd">use</span><span class="pln"> </span><span class="typ">Sensio</span><span class="pln">\Bundle\FrameworkExtraBundle\Configuration\Route</span><span class="pun">;</span></code></li><li class="L2"><code class="language-php"><span class="kwd">use</span><span class="pln"> </span><span class="typ">Sensio</span><span class="pln">\Bundle\FrameworkExtraBundle\Configuration\Template</span><span class="pun">;</span></code></li><li class="L3"><code class="language-php"></code></li><li class="L4"><code class="language-php"><span class="com">// ...</span></code></li><li class="L5"><code class="language-php"></code></li><li class="L6"><code class="language-php"><span class="com">/**</span></code></li><li class="L7"><code class="language-php"><span class="com"> * @Route(&quot;/hello/{name}.{_format}&quot;, defaults={&quot;_format&quot;=&quot;html&quot;}, name=&quot;hello&quot;)</span></code></li><li class="L8"><code class="language-php"><span class="com"> */</span></code></li><li class="L9"><code class="language-php"><span class="kwd">public</span><span class="pln"> </span><span class="kwd">function</span><span class="pln"> helloAction</span><span class="pun">(</span><span class="pln">$name</span><span class="pun">,</span><span class="pln"> $_format</span><span class="pun">)</span></code></li><li class="L0"><code class="language-php"><span class="pun">{</span></code></li><li class="L1"><code class="language-php"><span class="pln"> &nbsp; &nbsp;</span><span class="kwd">return</span><span class="pln"> $this</span><span class="pun">-&gt;</span><span class="pln">render</span><span class="pun">(</span><span class="str">&#39;default/hello.&#39;</span><span class="pun">.</span><span class="pln">$_format</span><span class="pun">.</span><span class="str">&#39;.twig&#39;</span><span class="pun">,</span><span class="pln"> array</span><span class="pun">(</span></code></li><li class="L2"><code class="language-php"><span class="pln"> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="str">&#39;name&#39;</span><span class="pln"> </span><span class="pun">=&gt;</span><span class="pln"> $name</span></code></li><li class="L3"><code class="language-php"><span class="pln"> &nbsp; &nbsp;</span><span class="pun">));</span></code></li><li class="L4"><code class="language-php"><span class="pun">}</span></code></li></ol></pre><p id="result" style="margin-top: 0px; margin-bottom: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;很显然，当你想要支持多种格式的请求时，你必须为每个支持的格式提供一个模板。在这种情况下，你应该创建一个新的<span style="line-height: 1.6;"><code class="docutils literal"><span style="line-height: 1.6; color: rgb(255, 0, 0);">hello.xml.twi g</span></code></span>模板：&nbsp;</p><pre class="prettyprint linenums prettyprinted" style=""><ol class="linenums list-paddingleft-2"><li class="L0"><code class="language-html"><span class="com">&lt;!-- app/Resources/views/default/hello.xml.twig --&gt;</span></code></li><li class="L1"><code class="language-html"><span class="tag">&lt;hello&gt;</span></code></li><li class="L2"><code class="language-html"><span class="pln"> &nbsp; &nbsp;</span><span class="tag">&lt;name&gt;</span><span class="pln">{{ name }}</span><span class="tag">&lt;/name&gt;</span></code></li><li class="L3"><code class="language-html"><span class="tag">&lt;/hello&gt;</span></code></li></ol></pre><p>&nbsp;&nbsp;&nbsp;&nbsp;现在,当你访问<span style="line-height: 1.6;"><code class="docutils literal"><span style="line-height: 1.6; color: rgb(255, 0, 0);">http://localhost:8000/hello/fabien</span></code></span>时,你会看到普通的HTML页面,因为<span style="line-height: 1.6;"><code class="docutils literal"><span style="line-height: 1.6; color: rgb(255, 0, 0);">html</span></code></span>是默认格式,当访问<span style="line-height: 1.6;"><code class="docutils literal"><span style="line-height: 1.6; color: rgb(255, 0, 0);">http://localhost:8000/hello/fabien.html</span></code></span>时,<span style="line-height: 27px;">&nbsp;你会再次得到HTML页面， &nbsp;&nbsp;这是<span style="line-height: 27px;">因为</span>这次你已经明确要求为</span><span style="line-height: 1.6;"><code class="docutils literal"><span style="line-height: 1.6; color: rgb(255, 0, 0);">html</span></code></span><span style="line-height: 27px;">格式 &nbsp; .最后,你可以访问</span><span style="line-height: 1.6;"><code class="docutils literal"><span style="line-height: 1.6; color: rgb(255, 0, 0);">http://localhost:8000/hello/fabien.xml</span></code></span><span style="line-height: 27px;">&nbsp;,</span><span style="line-height: 27px;">你会看到在你的浏览器中呈现新的XML模板。</span></p><p><span style="line-height: 27px;">&nbsp;&nbsp;&nbsp;&nbsp;还有一点,对于标准的格式,</span><span style="line-height: 27px;">Symfony的也将自动选择最好的</span><span style="line-height: 1.6;"><code class="docutils literal"><span style="line-height: 1.6; color: rgb(255, 0, 0);">Content-Type</span></code></span><span style="line-height: 27px;">首部去响应.如果你想要限制一个给定的动作给支持的格式,你可以使用</span><span style="line-height: 1.6;"><code class="docutils literal"><span style="line-height: 1.6; color: rgb(255, 0, 0);">@Route()</span></code></span><span style="line-height: 27px;">注释的</span><span style="line-height: 1.6;"><code class="docutils literal"><span style="line-height: 1.6; color: rgb(255, 0, 0);">requirements</span></code></span><span style="line-height: 27px;">选项,如下所示:</span></p><pre class="prettyprint linenums prettyprinted" style=""><ol class="linenums list-paddingleft-2"><li class="L0"><code class="language-php"><span class="com">// src/AppBundle/Controller/DefaultController.php</span></code></li><li class="L1"><code class="language-php"><span class="kwd">use</span><span class="pln"> </span><span class="typ">Sensio</span><span class="pln">\Bundle\FrameworkExtraBundle\Configuration\Route</span><span class="pun">;</span></code></li><li class="L2"><code class="language-php"><span class="kwd">use</span><span class="pln"> </span><span class="typ">Sensio</span><span class="pln">\Bundle\FrameworkExtraBundle\Configuration\Template</span><span class="pun">;</span></code></li><li class="L3"><code class="language-php"></code></li><li class="L4"><code class="language-php"><span class="com">// ...</span></code></li><li class="L5"><code class="language-php"></code></li><li class="L6"><code class="language-php"><span class="com">/**</span></code></li><li class="L7"><code class="language-php"><span class="com"> * @Route(&quot;/hello/{name}.{_format}&quot;,</span></code></li><li class="L8"><code class="language-php"><span class="com"> * &nbsp; &nbsp; defaults = {&quot;_format&quot;=&quot;html&quot;},</span></code></li><li class="L9"><code class="language-php"><span class="com"> * &nbsp; &nbsp; requirements = { &quot;_format&quot; = &quot;html|xml|json&quot; },</span></code></li><li class="L0"><code class="language-php"><span class="com"> * &nbsp; &nbsp; name = &quot;hello&quot;</span></code></li><li class="L1"><code class="language-php"><span class="com"> * )</span></code></li><li class="L2"><code class="language-php"><span class="com"> */</span></code></li><li class="L3"><code class="language-php"><span class="kwd">public</span><span class="pln"> </span><span class="kwd">function</span><span class="pln"> helloAction</span><span class="pun">(</span><span class="pln">$name</span><span class="pun">,</span><span class="pln"> $_format</span><span class="pun">)</span></code></li><li class="L4"><code class="language-php"><span class="pun">{</span></code></li><li class="L5"><code class="language-php"><span class="pln"> &nbsp; &nbsp;</span><span class="kwd">return</span><span class="pln"> $this</span><span class="pun">-&gt;</span><span class="pln">render</span><span class="pun">(</span><span class="str">&#39;default/hello.&#39;</span><span class="pun">.</span><span class="pln">$_format</span><span class="pun">.</span><span class="str">&#39;.twig&#39;</span><span class="pun">,</span><span class="pln"> array</span><span class="pun">(</span></code></li><li class="L6"><code class="language-php"><span class="pln"> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="str">&#39;name&#39;</span><span class="pln"> </span><span class="pun">=&gt;</span><span class="pln"> $name</span></code></li><li class="L7"><code class="language-php"><span class="pln"> &nbsp; &nbsp;</span><span class="pun">));</span></code></li><li class="L8"><code class="language-php"><span class="pun">}</span></code></li></ol></pre><p id="result" style="margin-top: 0px; margin-bottom: 0px;">这样一来,该<span style="line-height: 1.6;"><code class="docutils literal"><span style="line-height: 1.6; color: rgb(255, 0, 0);">hello</span></code></span>动作将匹配像<span style="line-height: 1.6;"><code class="docutils literal"><span style="line-height: 1.6; color: rgb(255, 0, 0);">/hello/fabien.xml</span></code></span>或<span style="line-height: 1.6;"><code class="docutils literal"><span style="line-height: 1.6; color: rgb(255, 0, 0);">/hello/fabien.json</span></code></span>的网址.如果你尝试得到像<span style="line-height: 1.6;"><code class="docutils literal"><span style="line-height: 1.6; color: rgb(255, 0, 0);">/hello/fabien.js</span></code></span><code class="docutils literal"><span class="pre">的</span></code>网址，它会返回一个404错误页面,因为<span style="line-height: 1.6;"><code class="docutils literal"><span style="line-height: 1.6; color: rgb(255, 0, 0);">_format</span></code></span>变量的值不符合其要求。</p><p>
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</p><h2>重定向(<span style="font-size: 1.33rem; font-weight: bold; line-height: 1.6;">Redirecting</span>) &nbsp; &nbsp; &nbsp; &nbsp;</h2><p id="result" style="margin-top: 0px; margin-bottom: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;如果您想将用户重定向到另一个页面，使用<code class="docutils literal"><span class="pre">redirectToRoute()</span></code>方法：</p><pre class="prettyprint linenums prettyprinted" style=""><ol class="linenums list-paddingleft-2"><li class="L0"><code class="language-php"><span class="com">// src/AppBundle/Controller/DefaultController.php</span></code></li><li class="L1"><code class="language-php"><span class="kwd">class</span><span class="pln"> </span><span class="typ">DefaultController</span><span class="pln"> </span><span class="kwd">extends</span><span class="pln"> </span><span class="typ">Controller</span></code></li><li class="L2"><code class="language-php"><span class="pun">{</span></code></li><li class="L3"><code class="language-php"><span class="pln"> &nbsp; &nbsp;</span><span class="com">/**</span></code></li><li class="L4"><code class="language-php"><span class="com"> &nbsp; &nbsp; * @Route(&quot;/&quot;, name=&quot;homepage&quot;)</span></code></li><li class="L5"><code class="language-php"><span class="com"> &nbsp; &nbsp; */</span></code></li><li class="L6"><code class="language-php"><span class="pln"> &nbsp; &nbsp;</span><span class="kwd">public</span><span class="pln"> </span><span class="kwd">function</span><span class="pln"> indexAction</span><span class="pun">()</span></code></li><li class="L7"><code class="language-php"><span class="pln"> &nbsp; &nbsp;</span><span class="pun">{</span></code></li><li class="L8"><code class="language-php"><span class="pln"> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="kwd">return</span><span class="pln"> $this</span><span class="pun">-&gt;</span><span class="pln">redirectToRoute</span><span class="pun">(</span><span class="str">&#39;hello&#39;</span><span class="pun">,</span><span class="pln"> array</span><span class="pun">(</span><span class="str">&#39;name&#39;</span><span class="pln"> </span><span class="pun">=&gt;</span><span class="pln"> </span><span class="str">&#39;Fabien&#39;</span><span class="pun">));</span></code></li><li class="L9"><code class="language-php"><span class="pln"> &nbsp; &nbsp;</span><span class="pun">}</span></code></li><li class="L0"><code class="language-php"><span class="pun">}</span></code></li></ol></pre><br/><p id="result" style="margin-top: 0px; margin-bottom: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;<span style="line-height: 1.6;"><code class="docutils literal"><span style="line-height: 1.6; color: rgb(255, 0, 0);">redirectToRoute()</span></code></span>方法利用<span style="line-height: 27px;">参数的路由名称和作为参数的可选数组去生成URL,并且向重定向站点.</span></p>
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<h2>显示错误页面(<span style="font-size: 1.33rem; font-weight: bold; font-family: Helvetica, &#39;Hiragino Sans GB&#39;, &#39;Microsoft Yahei&#39;, SimSun, SimHei, arial, sans-serif; line-height: 1.6;">Displaying Error Pages</span><span style="line-height: 1.6;">)</span></h2><p><span style="line-height: 1.6;">&nbsp;&nbsp;&nbsp;&nbsp;每个Web应用程序的执行过程中不可避免地发生错误。在</span><span style="line-height: 1.6;"><code class="docutils literal"><span style="line-height: 1.6; color: rgb(255, 0, 0);">404</span></code></span><span style="line-height: 1.6;">错误的情况下，Symfony提供了一个快捷的处理方式，你可以在你的控制器使用如下方法：</span><br/></p><p><span style="line-height: 1.6;"></span></p><pre class="prettyprint linenums prettyprinted" style=""><ol class="linenums list-paddingleft-2"><li class="L0"><code class="language-php"><span class="com">// src/AppBundle/Controller/DefaultController.php</span></code></li><li class="L1"><code class="language-php"><span class="com">// ...</span></code></li><li class="L2"><code class="language-php"></code></li><li class="L3"><code class="language-php"><span class="kwd">class</span><span class="pln"> </span><span class="typ">DefaultController</span><span class="pln"> </span><span class="kwd">extends</span><span class="pln"> </span><span class="typ">Controller</span></code></li><li class="L4"><code class="language-php"><span class="pun">{</span></code></li><li class="L5"><code class="language-php"><span class="pln"> &nbsp; &nbsp;</span><span class="com">/**</span></code></li><li class="L6"><code class="language-php"><span class="com"> &nbsp; &nbsp; * @Route(&quot;/&quot;, name=&quot;homepage&quot;)</span></code></li><li class="L7"><code class="language-php"><span class="com"> &nbsp; &nbsp; */</span></code></li><li class="L8"><code class="language-php"><span class="pln"> &nbsp; &nbsp;</span><span class="kwd">public</span><span class="pln"> </span><span class="kwd">function</span><span class="pln"> indexAction</span><span class="pun">()</span></code></li><li class="L9"><code class="language-php"><span class="pln"> &nbsp; &nbsp;</span><span class="pun">{</span></code></li><li class="L0"><code class="language-php"><span class="pln"> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="com">// ...</span></code></li><li class="L1"><code class="language-php"><span class="pln"> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="kwd">throw</span><span class="pln"> $this</span><span class="pun">-&gt;</span><span class="pln">createNotFoundException</span><span class="pun">();</span></code></li><li class="L2"><code class="language-php"><span class="pln"> &nbsp; &nbsp;</span><span class="pun">}</span></code></li><li class="L3"><code class="language-php"><span class="pun">}</span></code></li></ol></pre><p><span style="line-height: 1.6;">&nbsp;&nbsp;&nbsp;&nbsp;对于</span><span style="line-height: 1.6;"><code class="docutils literal"><span style="line-height: 1.6; color: rgb(255, 0, 0);">500</span></code></span><span style="line-height: 1.6;">错误，PHP异常控制器只是抛出一个普通的异常,但Symfony却将它改造成一个适当的</span><span style="line-height: 1.6;"><code class="docutils literal"><span style="line-height: 1.6; color: rgb(255, 0, 0);">500</span></code></span><span style="line-height: 1.6;">错误页面：</span><br/></p><p><span style="line-height: 1.6;"></span></p><pre class="prettyprint linenums prettyprinted" style=""><ol class="linenums list-paddingleft-2"><li class="L0"><code class="language-php"><span class="com">// src/AppBundle/Controller/DefaultController.php</span></code></li><li class="L1"><code class="language-php"><span class="com">// ...</span></code></li><li class="L2"><code class="language-php"></code></li><li class="L3"><code class="language-php"><span class="kwd">class</span><span class="pln"> </span><span class="typ">DefaultController</span><span class="pln"> </span><span class="kwd">extends</span><span class="pln"> </span><span class="typ">Controller</span></code></li><li class="L4"><code class="language-php"><span class="pun">{</span></code></li><li class="L5"><code class="language-php"><span class="pln"> &nbsp; &nbsp;</span><span class="com">/**</span></code></li><li class="L6"><code class="language-php"><span class="com"> &nbsp; &nbsp; * @Route(&quot;/&quot;, name=&quot;homepage&quot;)</span></code></li><li class="L7"><code class="language-php"><span class="com"> &nbsp; &nbsp; */</span></code></li><li class="L8"><code class="language-php"><span class="pln"> &nbsp; &nbsp;</span><span class="kwd">public</span><span class="pln"> </span><span class="kwd">function</span><span class="pln"> indexAction</span><span class="pun">()</span></code></li><li class="L9"><code class="language-php"><span class="pln"> &nbsp; &nbsp;</span><span class="pun">{</span></code></li><li class="L0"><code class="language-php"><span class="pln"> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="com">// ...</span></code></li><li class="L1"><code class="language-php"><span class="pln"> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="kwd">throw</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> \Exception</span><span class="pun">(</span><span class="str">&#39;Something went horribly wrong!&#39;</span><span class="pun">);</span></code></li><li class="L2"><code class="language-php"><span class="pln"> &nbsp; &nbsp;</span><span class="pun">}</span></code></li><li class="L3"><code class="language-php"><span class="pun">}</span></code></li></ol></pre><h2>从请求中获取信息(<span style="font-size: 1.33rem; font-weight: bold; line-height: 1.6;">Getting Information from the Request</span>)<br/></h2><p><span style="line-height: 1.6;">&nbsp;&nbsp;&nbsp;&nbsp;有时你的控制器需要访问信息依赖于用户请求，例如他们更喜欢的语言,IP地址或URL查询参数。要访问这些信息，需要添加一个新类型的</span><span style="line-height: 1.6;"><code class="docutils literal"><span style="line-height: 1.6; color: rgb(255, 0, 0);">Request</span></code></span><span style="line-height: 1.6;">的动作参数。这个新参
数的名称并不重要，但必须是工作之前的请求类型</span><span style="line-height: 1.6;">（不要忘了补充</span><span style="line-height: 1.6;"><code class="docutils literal"><span style="line-height: 1.6; color: rgb(255, 0, 0);">use</span></code></span><span style="line-height: 1.6;">申明，导入这个</span><span style="line-height: 1.6;"><code class="docutils literal"><span style="line-height: 1.6; color: rgb(255, 0, 0);">Request</span></code></span><span style="line-height: 1.6;">类）:</span></p><p><span style="line-height: 1.6;"><br/></span></p><pre class="prettyprint linenums prettyprinted" style=""><ol class="linenums list-paddingleft-2"><li class="L0"><code class="language-php"><span class="com">// src/AppBundle/Controller/DefaultController.php</span></code></li><li class="L1"><code class="language-php"><span class="kwd">namespace</span><span class="pln"> </span><span class="typ">AppBundle</span><span class="pln">\Controller</span><span class="pun">;</span></code></li><li class="L2"><code class="language-php"></code></li><li class="L3"><code class="language-php"><span class="kwd">use</span><span class="pln"> </span><span class="typ">Sensio</span><span class="pln">\Bundle\FrameworkExtraBundle\Configuration\Route</span><span class="pun">;</span></code></li><li class="L4"><code class="language-php"><span class="kwd">use</span><span class="pln"> </span><span class="typ">Symfony</span><span class="pln">\Bundle\FrameworkBundle\Controller\Controller</span><span class="pun">;</span></code></li><li class="L5"><code class="language-php"><span class="kwd">use</span><span class="pln"> </span><span class="typ">Symfony</span><span class="pln">\Component\HttpFoundation\Request</span><span class="pun">;</span></code></li><li class="L6"><code class="language-php"></code></li><li class="L7"><code class="language-php"><span class="kwd">class</span><span class="pln"> </span><span class="typ">DefaultController</span><span class="pln"> </span><span class="kwd">extends</span><span class="pln"> </span><span class="typ">Controller</span></code></li><li class="L8"><code class="language-php"><span class="pun">{</span></code></li><li class="L9"><code class="language-php"><span class="pln"> &nbsp; &nbsp;</span><span class="com">/**</span></code></li><li class="L0"><code class="language-php"><span class="com"> &nbsp; &nbsp; * @Route(&quot;/&quot;, name=&quot;homepage&quot;)</span></code></li><li class="L1"><code class="language-php"><span class="com"> &nbsp; &nbsp; */</span></code></li><li class="L2"><code class="language-php"><span class="pln"> &nbsp; &nbsp;</span><span class="kwd">public</span><span class="pln"> </span><span class="kwd">function</span><span class="pln"> indexAction</span><span class="pun">(</span><span class="typ">Request</span><span class="pln"> $request</span><span class="pun">)</span></code></li><li class="L3"><code class="language-php"><span class="pln"> &nbsp; &nbsp;</span><span class="pun">{</span></code></li><li class="L4"><code class="language-php"><span class="pln"> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="com">// is it an Ajax request?</span></code></li><li class="L5"><code class="language-php"><span class="pln"> &nbsp; &nbsp; &nbsp; &nbsp;$isAjax </span><span class="pun">=</span><span class="pln"> $request</span><span class="pun">-&gt;</span><span class="pln">isXmlHttpRequest</span><span class="pun">();</span></code></li><li class="L6"><code class="language-php"></code></li><li class="L7"><code class="language-php"><span class="pln"> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="com">// what&#39;s the preferred language of the user?</span></code></li><li class="L8"><code class="language-php"><span class="pln"> &nbsp; &nbsp; &nbsp; &nbsp;$language </span><span class="pun">=</span><span class="pln"> $request</span><span class="pun">-&gt;</span><span class="pln">getPreferredLanguage</span><span class="pun">(</span><span class="pln">array</span><span class="pun">(</span><span class="str">&#39;en&#39;</span><span class="pun">,</span><span class="pln"> </span><span class="str">&#39;fr&#39;</span><span class="pun">));</span></code></li><li class="L9"><code class="language-php"></code></li><li class="L0"><code class="language-php"><span class="pln"> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="com">// get the value of a $_GET parameter</span></code></li><li class="L1"><code class="language-php"><span class="pln"> &nbsp; &nbsp; &nbsp; &nbsp;$pageName </span><span class="pun">=</span><span class="pln"> $request</span><span class="pun">-&gt;</span><span class="pln">query</span><span class="pun">-&gt;</span><span class="kwd">get</span><span class="pun">(</span><span class="str">&#39;page&#39;</span><span class="pun">);</span></code></li><li class="L2"><code class="language-php"></code></li><li class="L3"><code class="language-php"><span class="pln"> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="com">// get the value of a $_POST parameter</span></code></li><li class="L4"><code class="language-php"><span class="pln"> &nbsp; &nbsp; &nbsp; &nbsp;$pageName </span><span class="pun">=</span><span class="pln"> $request</span><span class="pun">-&gt;</span><span class="pln">request</span><span class="pun">-&gt;</span><span class="kwd">get</span><span class="pun">(</span><span class="str">&#39;page&#39;</span><span class="pun">);</span></code></li><li class="L5"><code class="language-php"><span class="pln"> &nbsp; &nbsp;</span><span class="pun">}</span></code></li><li class="L6"><code class="language-php"><span class="pun">}</span></code></li></ol></pre><p id="result" style="margin-top: 0px; margin-bottom: 0px;">&nbsp;&nbsp;&nbsp;&nbsp;在模板中，你<span style="line-height: 1.6;">还可以通过由Symfony的自动提供的特殊</span><span style="line-height: 1.6;"><code class="docutils literal"><span style="line-height: 1.6; color: rgb(255, 0, 0);">app.request</span></code></span><span style="line-height: 1.6;">变量来访问</span><span style="line-height: 1.6;"><code class="docutils literal"><span style="line-height: 1.6; color: rgb(255, 0, 0);">Request</span></code></span><span style="line-height: 1.6;">对象：</span></p><pre class="prettyprint linenums prettyprinted" style=""><ol class="linenums list-paddingleft-2"><li class="L0"><code class="language-php"><span class="pun">{{</span><span class="pln"> app</span><span class="pun">.</span><span class="pln">request</span><span class="pun">.</span><span class="pln">query</span><span class="pun">.</span><span class="kwd">get</span><span class="pun">(</span><span class="str">&#39;page&#39;</span><span class="pun">)</span><span class="pln"> </span><span class="pun">}}</span></code></li><li class="L1"><code class="language-php"></code></li><li class="L2"><code class="language-php"><span class="pun">{{</span><span class="pln"> app</span><span class="pun">.</span><span class="pln">request</span><span class="pun">.</span><span class="pln">request</span><span class="pun">.</span><span class="kwd">get</span><span class="pun">(</span><span class="str">&#39;page&#39;</span><span class="pun">)</span><span class="pln"> </span><span class="pun">}}</span></code></li></ol></pre><br/><h2>在会话中持久化数据(<span style="font-size: 1.33rem; font-weight: bold; font-family: Helvetica, &#39;Hiragino Sans GB&#39;, &#39;Microsoft Yahei&#39;, SimSun, SimHei, arial, sans-serif; line-height: 1.6;">Persisting Data in the Session</span><span style="line-height: 1.6;">) &nbsp; &nbsp;&nbsp;</span></h2><p><span style="line-height: 1.6;"></span></p><p><span style="line-height: 1.6;">&nbsp;&nbsp;&nbsp;&nbsp;虽然</span><span style="line-height: 1.6;"><code class="docutils literal"><span style="line-height: 1.6; color: rgb(255, 0, 0);">HTTP</span></code></span><span style="line-height: 1.6;">协议是无状态的，但是Symfony的提供了一个很好的会话对象表示客户（无论是使用浏览器一个真正的人，还是一个机器人，或Web服务）。在两个请求之间，Symfony的使用PHP本身的会话存储在</span><span style="line-height: 1.6;"><code class="docutils literal"><span style="line-height: 1.6; color: rgb(255, 0, 0);">cookie</span></code></span><span style="line-height: 1.6;">中的属性。</span><br/></p><p id="result" style="margin-top: 0px; margin-bottom: 0px;">&nbsp;&nbsp;&nbsp;<span style="line-height: 27px;">存储和</span>检索来自session<span style="line-height: 27px;">信息</span>可以通过任何控制器来实现：</p><pre class="prettyprint linenums prettyprinted" style=""><ol class="linenums list-paddingleft-2"><li class="L0"><code class="language-php"><span class="kwd">use</span><span class="pln"> </span><span class="typ">Symfony</span><span class="pln">\Component\HttpFoundation\Request</span><span class="pun">;</span></code></li><li class="L1"><code class="language-php"></code></li><li class="L2"><code class="language-php"><span class="kwd">public</span><span class="pln"> </span><span class="kwd">function</span><span class="pln"> indexAction</span><span class="pun">(</span><span class="typ">Request</span><span class="pln"> $request</span><span class="pun">)</span></code></li><li class="L3"><code class="language-php"><span class="pun">{</span></code></li><li class="L4"><code class="language-php"><span class="pln"> &nbsp; &nbsp;$session </span><span class="pun">=</span><span class="pln"> $request</span><span class="pun">-&gt;</span><span class="pln">getSession</span><span class="pun">();</span></code></li><li class="L5"><code class="language-php"></code></li><li class="L6"><code class="language-php"><span class="pln"> &nbsp; &nbsp;</span><span class="com">// store an attribute for reuse during a later user request</span></code></li><li class="L7"><code class="language-php"><span class="pln"> &nbsp; &nbsp;$session</span><span class="pun">-&gt;</span><span class="kwd">set</span><span class="pun">(</span><span class="str">&#39;foo&#39;</span><span class="pun">,</span><span class="pln"> </span><span class="str">&#39;bar&#39;</span><span class="pun">);</span></code></li><li class="L8"><code class="language-php"></code></li><li class="L9"><code class="language-php"><span class="pln"> &nbsp; &nbsp;</span><span class="com">// get the value of a session attribute</span></code></li><li class="L0"><code class="language-php"><span class="pln"> &nbsp; &nbsp;$foo </span><span class="pun">=</span><span class="pln"> $session</span><span class="pun">-&gt;</span><span class="kwd">get</span><span class="pun">(</span><span class="str">&#39;foo&#39;</span><span class="pun">);</span></code></li><li class="L1"><code class="language-php"></code></li><li class="L2"><code class="language-php"><span class="pln"> &nbsp; &nbsp;</span><span class="com">// use a default value if the attribute doesn&#39;t exist</span></code></li><li class="L3"><code class="language-php"><span class="pln"> &nbsp; &nbsp;$foo </span><span class="pun">=</span><span class="pln"> $session</span><span class="pun">-&gt;</span><span class="kwd">get</span><span class="pun">(</span><span class="str">&#39;foo&#39;</span><span class="pun">,</span><span class="pln"> </span><span class="str">&#39;default_value&#39;</span><span class="pun">);</span></code></li><li class="L4"><code class="language-php"><span class="pun">}</span></code></li></ol></pre><p><span style="line-height: 1.6;">&nbsp;&nbsp;&nbsp;&nbsp;你还可以存储“提示信息(</span><span style="line-height: 1.6;"><code class="docutils literal"><span style="line-height: 1.6; color: rgb(255, 0, 0);">flash messages</span></code></span><span style="line-height: 1.6;">)”,这条信息将下一个请求后被自动删除。当需要将用户重定向至另一页面（将显示消息）之前设置成功消息时,这是非常有用的： &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><br/></p><pre class="prettyprint linenums prettyprinted" style=""><ol class="linenums list-paddingleft-2"><li class="L0"><code class="language-php"><span class="kwd">public</span><span class="pln"> </span><span class="kwd">function</span><span class="pln"> indexAction</span><span class="pun">(</span><span class="typ">Request</span><span class="pln"> $request</span><span class="pun">)</span></code></li><li class="L1"><code class="language-php"><span class="pun">{</span></code></li><li class="L2"><code class="language-php"><span class="pln"> &nbsp; &nbsp;</span><span class="com">// ...</span></code></li><li class="L3"><code class="language-php"></code></li><li class="L4"><code class="language-php"><span class="pln"> &nbsp; &nbsp;</span><span class="com">// store a message for the very next request</span></code></li><li class="L5"><code class="language-php"><span class="pln"> &nbsp; &nbsp;$this</span><span class="pun">-&gt;</span><span class="pln">addFlash</span><span class="pun">(</span><span class="str">&#39;notice&#39;</span><span class="pun">,</span><span class="pln"> </span><span class="str">&#39;Congratulations, your action succeeded!&#39;</span><span class="pun">);</span></code></li><li class="L6"><code class="language-php"><span class="pun">}</span></code></li></ol></pre><p id="result" style="margin-top: 0px; margin-bottom: 0px;">你也可以在模板中显示提示消息,像这样：</p><pre class="prettyprint linenums prettyprinted" style=""><ol class="linenums list-paddingleft-2"><li class="L0"><code class="language-php"><span class="tag">&lt;div&gt;</span></code></li><li class="L1"><code class="language-php"><span class="pln"> &nbsp; &nbsp;{{ app.session.flashbag.get(&#39;notice&#39;) }}</span></code></li><li class="L2"><code class="language-php"><span class="tag">&lt;/div&gt;</span></code></li></ol></pre><br/><h2>最后的思考</h2><p><span style="line-height: 1.6;">&nbsp;&nbsp;&nbsp;&nbsp;这一切就是这么简单，我甚至不知道你已经花了整整10分钟。我在第一部分简要介绍了捆绑，而你迄今为止已经了解了Symfony功能核心框架包的一部分。但由于捆绑，一切都在Symfony中是可扩展或和可替换的。这将在后面讲到.</span><br/></p><p></p><p><span style="line-height: 1.6;"><br/></span></p><h2><span style="line-height: 1.6;">我的主页:<a href="http://aifei8.net">http://aifei8.net</a>:</span></h2><p><span style="line-height: 1.6;"></span></p><div><img border="0" src="第3章.Symfony 快速入门-控制器_files/2bc4b8e6-ed92-4174-83ef-511e72b978d4.png" /></div><div><img border="0" src="第3章.Symfony 快速入门-控制器_files/89f21de2-8ae9-4609-ace7-2be6e53a2d4f.png" /></div><p><span style="line-height: 1.6;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</span><br/></p><h2 style="margin-top: 0px; margin-bottom: 0px;">我的博客:<a href="http://blog.aifei8.net">http://blog.aifei8.net</a> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br/></h2><h2>github主页:<a href="http://github.com/Pengfei-Gao">http://github.com/Pengfei-Gao</a> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</h2><p>&nbsp;</p><div><img border="0" src="第3章.Symfony 快速入门-控制器_files/c8a0602d-a0a6-4862-bd6a-684e22595b7d.png" /></div><p> <img border="0" width="109" height="44" _src="file:///tmp/WizNote/b024b896-e570-4fe8-9057-17effdc58b5f/第3章.Symfony 快速入门-控制器_files/c1351b29-d6fc-4d5b-a55a-3e33dfca5515.gif" style="height: 44px; line-height: 1.6; white-space: normal; font-weight: bold; width: 109px;" src="第3章.Symfony 快速入门-控制器_files/c1351b29-d6fc-4d5b-a55a-3e33dfca5515.gif" />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br/></p><p><span style="line-height: 1.6;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span style="line-height: 1.6;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><br/></p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br/></p><p><span style="line-height: 1.6;"></span><br/></p><p>
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</p><p><span style="line-height: 1.6;"><br/></span><br/></p><p>
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</p><p><span style="line-height: 27px;"></span></p><br/>
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<p id="result" style="margin-top: 0px; margin-bottom: 0px;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br/></p><p>
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</p><p>
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</p><p><span style="line-height: 1.6;"></span><br/></p><p>
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</p><p><span style="line-height: 1.6;"></span><br/></p><p><br/></p></body></html>